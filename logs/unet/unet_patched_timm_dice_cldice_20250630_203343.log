2025-06-30 20:33:43 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnet50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}, 'dataset': {'root': '/home/smadper/TFM/datasets/laticifers', 'image_size': [512, 512], 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 20, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'dist_transform': True}, 'train': {'batch_size': 8, 'num_epochs': 50, 'learning_rate': 0.001, 'accumulation_steps': 8, 'save_dir': '/home/smadper/TFM/checkpoints', 'log_interval': 1, 'patience': 10, 'experiment_name': 'unet_patched_timm_dice_cldice', 'timestamp': '20250630_203343'}, 'test': {'batch_size': 1, 'save_dir': '/home/smadper/TFM/results'}, 'loss': {'name': 'dice_cldice', 'cldice_alpha': 0.3, 'use_topographic': True, 'combine_with': 'dice', 'weights': {'main': 1.0, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-06-30 20:33:43 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnet50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}
2025-06-30 20:33:44 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-06-30 20:33:44 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-06-30 20:33:44 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-06-30 20:33:44 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-06-30 20:35:28 INFO Epoch 001 | Train Loss: 0.8766 | Val Loss: 0.8578 | Dice: 0.1504 | IoU: 0.0814 | LR: 0.001000
2025-06-30 20:37:12 INFO Epoch 002 | Train Loss: 0.7995 | Val Loss: 0.8003 | Dice: 0.2216 | IoU: 0.1247 | LR: 0.001000
2025-06-30 20:38:56 INFO Epoch 003 | Train Loss: 0.7387 | Val Loss: 0.7707 | Dice: 0.2169 | IoU: 0.1217 | LR: 0.001000
2025-06-30 20:40:39 INFO Epoch 004 | Train Loss: 0.6965 | Val Loss: 0.7128 | Dice: 0.2954 | IoU: 0.1736 | LR: 0.001000
2025-06-30 20:42:23 INFO Epoch 005 | Train Loss: 0.6686 | Val Loss: 0.6639 | Dice: 0.3755 | IoU: 0.2312 | LR: 0.001000
2025-06-30 20:44:07 INFO Epoch 006 | Train Loss: 0.6402 | Val Loss: 0.6351 | Dice: 0.4195 | IoU: 0.2655 | LR: 0.001000
2025-06-30 20:45:51 INFO Epoch 007 | Train Loss: 0.6067 | Val Loss: 0.6160 | Dice: 0.4076 | IoU: 0.2560 | LR: 0.001000
2025-06-30 20:47:35 INFO Epoch 008 | Train Loss: 0.5843 | Val Loss: 0.5848 | Dice: 0.4253 | IoU: 0.2702 | LR: 0.001000
2025-06-30 20:49:18 INFO Epoch 009 | Train Loss: 0.5599 | Val Loss: 0.5720 | Dice: 0.4237 | IoU: 0.2688 | LR: 0.001000
2025-06-30 20:51:02 INFO Epoch 010 | Train Loss: 0.5531 | Val Loss: 0.5658 | Dice: 0.4058 | IoU: 0.2547 | LR: 0.001000
2025-06-30 20:52:46 INFO Epoch 011 | Train Loss: 0.5441 | Val Loss: 0.5497 | Dice: 0.4355 | IoU: 0.2786 | LR: 0.001000
2025-06-30 20:54:29 INFO Epoch 012 | Train Loss: 0.5364 | Val Loss: 0.5287 | Dice: 0.4515 | IoU: 0.2917 | LR: 0.001000
2025-06-30 20:56:13 INFO Epoch 013 | Train Loss: 0.5253 | Val Loss: 0.5336 | Dice: 0.4392 | IoU: 0.2816 | LR: 0.001000
2025-06-30 20:57:57 INFO Epoch 014 | Train Loss: 0.5239 | Val Loss: 0.5306 | Dice: 0.4368 | IoU: 0.2795 | LR: 0.001000
2025-06-30 20:59:41 INFO Epoch 015 | Train Loss: 0.5177 | Val Loss: 0.5283 | Dice: 0.4295 | IoU: 0.2736 | LR: 0.001000
2025-06-30 21:01:24 INFO Epoch 016 | Train Loss: 0.5357 | Val Loss: 0.5303 | Dice: 0.4452 | IoU: 0.2864 | LR: 0.001000
2025-06-30 21:03:08 INFO Epoch 017 | Train Loss: 0.5234 | Val Loss: 0.5237 | Dice: 0.4369 | IoU: 0.2796 | LR: 0.001000
2025-06-30 21:04:52 INFO Epoch 018 | Train Loss: 0.5123 | Val Loss: 0.5242 | Dice: 0.4344 | IoU: 0.2775 | LR: 0.001000
2025-06-30 21:06:35 INFO Epoch 019 | Train Loss: 0.5224 | Val Loss: 0.5491 | Dice: 0.4223 | IoU: 0.2678 | LR: 0.001000
2025-06-30 21:08:19 INFO Epoch 020 | Train Loss: 0.5189 | Val Loss: 0.5208 | Dice: 0.4337 | IoU: 0.2770 | LR: 0.001000
2025-06-30 21:10:02 INFO Epoch 021 | Train Loss: 0.5101 | Val Loss: 0.5219 | Dice: 0.4488 | IoU: 0.2894 | LR: 0.001000
2025-06-30 21:11:46 INFO Epoch 022 | Train Loss: 0.5074 | Val Loss: 0.5138 | Dice: 0.4552 | IoU: 0.2948 | LR: 0.001000
2025-06-30 21:13:30 INFO Epoch 023 | Train Loss: 0.5095 | Val Loss: 0.5192 | Dice: 0.4431 | IoU: 0.2847 | LR: 0.001000
2025-06-30 21:15:14 INFO Epoch 024 | Train Loss: 0.5102 | Val Loss: 0.5119 | Dice: 0.4510 | IoU: 0.2913 | LR: 0.001000
2025-06-30 21:16:57 INFO Epoch 025 | Train Loss: 0.5071 | Val Loss: 0.5167 | Dice: 0.4565 | IoU: 0.2958 | LR: 0.001000
2025-06-30 21:18:41 INFO Epoch 026 | Train Loss: 0.5070 | Val Loss: 0.5122 | Dice: 0.4473 | IoU: 0.2882 | LR: 0.001000
2025-06-30 21:20:25 INFO Epoch 027 | Train Loss: 0.5033 | Val Loss: 0.5174 | Dice: 0.4480 | IoU: 0.2888 | LR: 0.001000
2025-06-30 21:22:08 INFO Epoch 028 | Train Loss: 0.5068 | Val Loss: 0.5162 | Dice: 0.4498 | IoU: 0.2903 | LR: 0.001000
2025-06-30 21:23:52 INFO Epoch 029 | Train Loss: 0.5096 | Val Loss: 0.5212 | Dice: 0.4481 | IoU: 0.2888 | LR: 0.001000
2025-06-30 21:25:35 INFO Epoch 030 | Train Loss: 0.4990 | Val Loss: 0.5253 | Dice: 0.4351 | IoU: 0.2781 | LR: 0.001000
2025-06-30 21:27:19 INFO Epoch 031 | Train Loss: 0.5092 | Val Loss: 0.5344 | Dice: 0.4209 | IoU: 0.2666 | LR: 0.001000
2025-06-30 21:29:03 INFO Epoch 032 | Train Loss: 0.5149 | Val Loss: 0.5293 | Dice: 0.4436 | IoU: 0.2851 | LR: 0.001000
2025-06-30 21:30:46 INFO Epoch 033 | Train Loss: 0.5054 | Val Loss: 0.5184 | Dice: 0.4358 | IoU: 0.2787 | LR: 0.001000
2025-06-30 21:32:30 INFO Early stopping at epoch 34 | Best Dice: 0.4565 at epoch 24
2025-06-30 21:33:10 INFO Test Loss: 0.5119 | Dice: 0.4510 | IoU: 0.2913
