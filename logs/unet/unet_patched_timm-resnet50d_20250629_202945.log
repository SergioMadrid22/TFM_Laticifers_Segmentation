2025-06-29 20:29:45 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnet50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}, 'dataset': {'root': '/home/smadper/TFM/datasets/laticifers', 'image_size': [512, 512], 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 5, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'dist_transform': True}, 'train': {'batch_size': 4, 'num_epochs': 50, 'learning_rate': 0.001, 'accumulation_steps': 8, 'save_dir': '/home/smadper/TFM/checkpoints', 'log_interval': 1, 'patience': 10, 'experiment_name': 'unet_patched_timm-resnet50d', 'timestamp': '20250629_202945'}, 'test': {'batch_size': 1, 'save_dir': '/home/smadper/TFM/results'}, 'loss': {'name': 'bce', 'use_topographic': True, 'combine_with': 'dice', 'weights': {'main': 1.0, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-06-29 20:29:45 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnet50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}
2025-06-29 20:29:46 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-06-29 20:29:46 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-06-29 20:29:46 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-06-29 20:29:46 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-06-29 20:30:22 INFO Epoch 001 | Train Loss: 1.6947 | Val Loss: 12.7745 | Dice: 0.0962 | IoU: 0.0506 | LR: 0.001000
2025-06-29 20:30:57 INFO Epoch 002 | Train Loss: 1.1758 | Val Loss: 5.5518 | Dice: 0.1186 | IoU: 0.0634 | LR: 0.001000
2025-06-29 20:31:33 INFO Epoch 003 | Train Loss: 0.8541 | Val Loss: 0.8670 | Dice: 0.1247 | IoU: 0.0675 | LR: 0.001000
2025-06-29 20:32:08 INFO Epoch 004 | Train Loss: 0.6590 | Val Loss: 0.5341 | Dice: 0.0385 | IoU: 0.0205 | LR: 0.001000
2025-06-29 20:32:44 INFO Epoch 005 | Train Loss: 0.5402 | Val Loss: 0.5104 | Dice: 0.0146 | IoU: 0.0074 | LR: 0.001000
2025-06-29 20:33:20 INFO Epoch 006 | Train Loss: 0.4503 | Val Loss: 0.4036 | Dice: 0.0001 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:33:56 INFO Epoch 007 | Train Loss: 0.3869 | Val Loss: 0.3551 | Dice: 0.0029 | IoU: 0.0014 | LR: 0.001000
2025-06-29 20:34:31 INFO Epoch 008 | Train Loss: 0.3428 | Val Loss: 0.3119 | Dice: 0.0050 | IoU: 0.0025 | LR: 0.001000
2025-06-29 20:35:07 INFO Epoch 009 | Train Loss: 0.3077 | Val Loss: 0.2674 | Dice: 0.0075 | IoU: 0.0038 | LR: 0.001000
2025-06-29 20:35:43 INFO Epoch 010 | Train Loss: 0.2771 | Val Loss: 3.0755 | Dice: 0.0315 | IoU: 0.0163 | LR: 0.001000
2025-06-29 20:36:18 INFO Epoch 011 | Train Loss: 0.2712 | Val Loss: 0.5075 | Dice: 0.0065 | IoU: 0.0033 | LR: 0.001000
2025-06-29 20:36:54 INFO Epoch 012 | Train Loss: 0.2544 | Val Loss: 0.4278 | Dice: 0.0099 | IoU: 0.0050 | LR: 0.001000
2025-06-29 20:37:29 INFO Epoch 013 | Train Loss: 0.2418 | Val Loss: 0.7752 | Dice: 0.0115 | IoU: 0.0059 | LR: 0.001000
2025-06-29 20:38:05 INFO Epoch 014 | Train Loss: 0.2323 | Val Loss: 0.2230 | Dice: 0.0033 | IoU: 0.0016 | LR: 0.001000
2025-06-29 20:38:41 INFO Epoch 015 | Train Loss: 0.2241 | Val Loss: 0.1900 | Dice: 0.0006 | IoU: 0.0003 | LR: 0.001000
2025-06-29 20:39:17 INFO Epoch 016 | Train Loss: 0.2188 | Val Loss: 0.4707 | Dice: 0.0077 | IoU: 0.0039 | LR: 0.001000
2025-06-29 20:39:52 INFO Epoch 017 | Train Loss: 0.2074 | Val Loss: 1.2168 | Dice: 0.0229 | IoU: 0.0118 | LR: 0.001000
2025-06-29 20:40:28 INFO Epoch 018 | Train Loss: 0.2030 | Val Loss: 0.1981 | Dice: 0.0065 | IoU: 0.0033 | LR: 0.001000
2025-06-29 20:41:04 INFO Epoch 019 | Train Loss: 0.1956 | Val Loss: 0.1561 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:41:39 INFO Epoch 020 | Train Loss: 0.1972 | Val Loss: 0.1622 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:42:15 INFO Epoch 021 | Train Loss: 0.1922 | Val Loss: 0.1483 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:42:51 INFO Epoch 022 | Train Loss: 0.1859 | Val Loss: 0.1439 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:43:27 INFO Epoch 023 | Train Loss: 0.1863 | Val Loss: 0.1483 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:44:02 INFO Epoch 024 | Train Loss: 0.1810 | Val Loss: 0.1433 | Dice: 0.0001 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:44:39 INFO Epoch 025 | Train Loss: 0.1791 | Val Loss: 0.1378 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:45:15 INFO Epoch 026 | Train Loss: 0.1808 | Val Loss: 0.1351 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:45:51 INFO Epoch 027 | Train Loss: 0.1728 | Val Loss: 0.1355 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:46:27 INFO Epoch 028 | Train Loss: 0.1717 | Val Loss: 0.1350 | Dice: 0.0004 | IoU: 0.0002 | LR: 0.001000
2025-06-29 20:47:03 INFO Epoch 029 | Train Loss: 0.1707 | Val Loss: 0.1309 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:47:39 INFO Epoch 030 | Train Loss: 0.1670 | Val Loss: 0.1299 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:48:14 INFO Epoch 031 | Train Loss: 0.1683 | Val Loss: 0.1330 | Dice: 0.0025 | IoU: 0.0012 | LR: 0.001000
2025-06-29 20:48:50 INFO Epoch 032 | Train Loss: 0.1625 | Val Loss: 0.1953 | Dice: 0.0006 | IoU: 0.0003 | LR: 0.001000
2025-06-29 20:49:26 INFO Epoch 033 | Train Loss: 0.1655 | Val Loss: 0.1445 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:50:01 INFO Epoch 034 | Train Loss: 0.1581 | Val Loss: 0.1354 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:50:37 INFO Epoch 035 | Train Loss: 0.1558 | Val Loss: 0.1257 | Dice: 0.0032 | IoU: 0.0016 | LR: 0.001000
2025-06-29 20:51:13 INFO Epoch 036 | Train Loss: 0.1616 | Val Loss: 0.1368 | Dice: 0.0037 | IoU: 0.0019 | LR: 0.001000
2025-06-29 20:51:48 INFO Epoch 037 | Train Loss: 0.1595 | Val Loss: 0.1340 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:52:24 INFO Epoch 038 | Train Loss: 0.1531 | Val Loss: 0.1233 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:53:00 INFO Epoch 039 | Train Loss: 0.1579 | Val Loss: 0.1198 | Dice: 0.0009 | IoU: 0.0004 | LR: 0.001000
2025-06-29 20:53:36 INFO Epoch 040 | Train Loss: 0.1521 | Val Loss: 0.1193 | Dice: 0.0003 | IoU: 0.0002 | LR: 0.001000
2025-06-29 20:54:12 INFO Epoch 041 | Train Loss: 0.1504 | Val Loss: 0.1186 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:54:48 INFO Epoch 042 | Train Loss: 0.1469 | Val Loss: 0.1180 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:55:24 INFO Epoch 043 | Train Loss: 0.1518 | Val Loss: 0.1192 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:56:00 INFO Epoch 044 | Train Loss: 0.1450 | Val Loss: 0.1217 | Dice: 0.0002 | IoU: 0.0001 | LR: 0.001000
2025-06-29 20:56:36 INFO Epoch 045 | Train Loss: 0.1445 | Val Loss: 0.1212 | Dice: 0.0005 | IoU: 0.0002 | LR: 0.001000
2025-06-29 20:57:12 INFO Epoch 046 | Train Loss: 0.1476 | Val Loss: 0.1169 | Dice: 0.0001 | IoU: 0.0001 | LR: 0.001000
2025-06-29 20:57:47 INFO Epoch 047 | Train Loss: 0.1447 | Val Loss: 0.1177 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:58:24 INFO Epoch 048 | Train Loss: 0.1358 | Val Loss: 0.1196 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:58:59 INFO Epoch 049 | Train Loss: 0.1431 | Val Loss: 0.1225 | Dice: 0.0000 | IoU: 0.0000 | LR: 0.001000
2025-06-29 20:59:35 INFO Epoch 050 | Train Loss: 0.1408 | Val Loss: 0.1289 | Dice: 0.0013 | IoU: 0.0007 | LR: 0.001000
2025-06-29 20:59:35 INFO Training completed.
