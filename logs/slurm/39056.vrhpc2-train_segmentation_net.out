2025-07-23 02:32:58 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 3, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'sato': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/sato_images', 'otsu': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/otsu_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_023258_unet_timm-resnest50d_hausdorff_dice', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_timm-resnest50d_hausdorff_dice', 'timestamp': '20250723_023258'}, 'test': {'batch_size': 1}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 02:32:58 INFO Experiment name: unet_timm-resnest50d_hausdorff_dice
2025-07-23 02:32:58 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 3, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 02:32:58 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 02:32:59 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 02:33:00 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 02:36:18 INFO Epoch 001 | Train Loss: 1.0320 | Val Loss: 0.9527 | Dice: 0.3275 | clDice: 0.3527 | IoU: 0.1966 | Tversky: 0.3275 | Hausdorff: 520.4179 | HD95: 116.0674 | LR: 0.001000
2025-07-23 02:39:26 INFO Epoch 002 | Train Loss: 0.8260 | Val Loss: 0.8240 | Dice: 0.4176 | clDice: 0.4591 | IoU: 0.2643 | Tversky: 0.4176 | Hausdorff: 600.8243 | HD95: 94.4916 | LR: 0.001000
2025-07-23 02:42:33 INFO Epoch 003 | Train Loss: 0.7998 | Val Loss: 0.8374 | Dice: 0.4112 | clDice: 0.4353 | IoU: 0.2591 | Tversky: 0.4112 | Hausdorff: 585.9278 | HD95: 104.5233 | LR: 0.001000
2025-07-23 02:45:36 INFO Epoch 004 | Train Loss: 0.7876 | Val Loss: 0.7891 | Dice: 0.4258 | clDice: 0.4584 | IoU: 0.2712 | Tversky: 0.4258 | Hausdorff: 247.5900 | HD95: 74.1614 | LR: 0.001000
2025-07-23 02:48:44 INFO Epoch 005 | Train Loss: 0.7797 | Val Loss: 0.7806 | Dice: 0.4403 | clDice: 0.4750 | IoU: 0.2829 | Tversky: 0.4403 | Hausdorff: 364.6622 | HD95: 68.6499 | LR: 0.001000
2025-07-23 02:51:51 INFO Epoch 006 | Train Loss: 0.7710 | Val Loss: 0.7574 | Dice: 0.4628 | clDice: 0.5029 | IoU: 0.3015 | Tversky: 0.4628 | Hausdorff: 521.5556 | HD95: 64.5053 | LR: 0.001000
2025-07-23 02:55:03 INFO Epoch 007 | Train Loss: 0.7592 | Val Loss: 0.7273 | Dice: 0.4634 | clDice: 0.5126 | IoU: 0.3021 | Tversky: 0.4634 | Hausdorff: 412.9646 | HD95: 59.2976 | LR: 0.001000
2025-07-23 02:58:21 INFO Epoch 008 | Train Loss: 0.7614 | Val Loss: 0.7564 | Dice: 0.4617 | clDice: 0.5019 | IoU: 0.3004 | Tversky: 0.4617 | Hausdorff: 390.3165 | HD95: 66.0335 | LR: 0.001000
2025-07-23 03:01:28 INFO Epoch 009 | Train Loss: 0.7608 | Val Loss: 0.7877 | Dice: 0.4419 | clDice: 0.4810 | IoU: 0.2839 | Tversky: 0.4419 | Hausdorff: 534.3993 | HD95: 82.1783 | LR: 0.001000
2025-07-23 03:04:40 INFO Epoch 010 | Train Loss: 0.7518 | Val Loss: 0.7292 | Dice: 0.4663 | clDice: 0.5148 | IoU: 0.3045 | Tversky: 0.4663 | Hausdorff: 534.7896 | HD95: 56.9299 | LR: 0.001000
2025-07-23 03:07:57 INFO Epoch 011 | Train Loss: 0.7486 | Val Loss: 0.7335 | Dice: 0.4693 | clDice: 0.5139 | IoU: 0.3070 | Tversky: 0.4693 | Hausdorff: 245.6711 | HD95: 51.8761 | LR: 0.001000
2025-07-23 03:11:16 INFO Epoch 012 | Train Loss: 0.7504 | Val Loss: 0.8684 | Dice: 0.2835 | clDice: 0.3004 | IoU: 0.1667 | Tversky: 0.2835 | Hausdorff: 449.4777 | HD95: 180.3515 | LR: 0.001000
2025-07-23 03:14:13 INFO Epoch 013 | Train Loss: 0.7484 | Val Loss: 0.7503 | Dice: 0.4647 | clDice: 0.5024 | IoU: 0.3032 | Tversky: 0.4647 | Hausdorff: 565.6922 | HD95: 65.1775 | LR: 0.001000
2025-07-23 03:17:14 INFO Epoch 014 | Train Loss: 0.7473 | Val Loss: 0.7622 | Dice: 0.4598 | clDice: 0.5012 | IoU: 0.2988 | Tversky: 0.4598 | Hausdorff: 278.1781 | HD95: 76.5402 | LR: 0.001000
2025-07-23 03:20:18 INFO Epoch 015 | Train Loss: 0.7432 | Val Loss: 0.7663 | Dice: 0.4588 | clDice: 0.4959 | IoU: 0.2979 | Tversky: 0.4588 | Hausdorff: 579.0684 | HD95: 87.8833 | LR: 0.001000
2025-07-23 03:23:25 INFO Epoch 016 | Train Loss: 0.7445 | Val Loss: 0.7304 | Dice: 0.4633 | clDice: 0.5061 | IoU: 0.3020 | Tversky: 0.4633 | Hausdorff: 264.6907 | HD95: 53.4436 | LR: 0.001000
2025-07-23 03:26:35 INFO Epoch 017 | Train Loss: 0.7390 | Val Loss: 0.7229 | Dice: 0.4721 | clDice: 0.5192 | IoU: 0.3092 | Tversky: 0.4721 | Hausdorff: 500.4851 | HD95: 53.8900 | LR: 0.001000
2025-07-23 03:29:36 INFO Epoch 018 | Train Loss: 0.7430 | Val Loss: 0.7420 | Dice: 0.4611 | clDice: 0.4983 | IoU: 0.3001 | Tversky: 0.4611 | Hausdorff: 490.5633 | HD95: 54.1772 | LR: 0.001000
2025-07-23 03:32:39 INFO Epoch 019 | Train Loss: 0.7422 | Val Loss: 0.7531 | Dice: 0.4543 | clDice: 0.4862 | IoU: 0.2942 | Tversky: 0.4543 | Hausdorff: 447.3912 | HD95: 76.9507 | LR: 0.001000
2025-07-23 03:35:46 INFO Epoch 020 | Train Loss: 0.7367 | Val Loss: 0.7349 | Dice: 0.4703 | clDice: 0.5018 | IoU: 0.3078 | Tversky: 0.4703 | Hausdorff: 566.0511 | HD95: 62.9601 | LR: 0.001000
2025-07-23 03:38:53 INFO Epoch 021 | Train Loss: 0.7370 | Val Loss: 0.8227 | Dice: 0.3444 | clDice: 0.3698 | IoU: 0.2082 | Tversky: 0.3444 | Hausdorff: 382.7386 | HD95: 123.6297 | LR: 0.001000
2025-07-23 03:41:52 INFO Epoch 022 | Train Loss: 0.7372 | Val Loss: 0.7624 | Dice: 0.4242 | clDice: 0.4561 | IoU: 0.2694 | Tversky: 0.4242 | Hausdorff: 455.8308 | HD95: 62.5974 | LR: 0.001000
2025-07-23 03:44:43 INFO Epoch 023 | Train Loss: 0.7350 | Val Loss: 0.7227 | Dice: 0.4581 | clDice: 0.4928 | IoU: 0.2974 | Tversky: 0.4581 | Hausdorff: 526.0772 | HD95: 52.1893 | LR: 0.001000
2025-07-23 03:47:47 INFO Epoch 024 | Train Loss: 0.7369 | Val Loss: 0.7398 | Dice: 0.4483 | clDice: 0.4768 | IoU: 0.2892 | Tversky: 0.4483 | Hausdorff: 523.8396 | HD95: 55.6297 | LR: 0.001000
2025-07-23 03:50:47 INFO Epoch 025 | Train Loss: 0.7355 | Val Loss: 0.7455 | Dice: 0.4625 | clDice: 0.4950 | IoU: 0.3012 | Tversky: 0.4625 | Hausdorff: 720.1763 | HD95: 71.6455 | LR: 0.001000
2025-07-23 03:53:52 INFO Epoch 026 | Train Loss: 0.7325 | Val Loss: 0.7436 | Dice: 0.4364 | clDice: 0.4689 | IoU: 0.2795 | Tversky: 0.4364 | Hausdorff: 528.3918 | HD95: 69.0974 | LR: 0.001000
2025-07-23 03:56:47 INFO Epoch 027 | Train Loss: 0.7312 | Val Loss: 0.7528 | Dice: 0.4478 | clDice: 0.4818 | IoU: 0.2890 | Tversky: 0.4478 | Hausdorff: 247.5774 | HD95: 60.2127 | LR: 0.001000
2025-07-23 03:59:48 INFO Epoch 028 | Train Loss: 0.7280 | Val Loss: 0.7694 | Dice: 0.4379 | clDice: 0.4627 | IoU: 0.2805 | Tversky: 0.4379 | Hausdorff: 526.7900 | HD95: 88.0662 | LR: 0.001000
2025-07-23 04:03:00 INFO Epoch 029 | Train Loss: 0.7279 | Val Loss: 0.7701 | Dice: 0.4333 | clDice: 0.4560 | IoU: 0.2770 | Tversky: 0.4333 | Hausdorff: 545.5402 | HD95: 81.4243 | LR: 0.001000
2025-07-23 04:06:17 INFO Epoch 030 | Train Loss: 0.7298 | Val Loss: 0.7737 | Dice: 0.4066 | clDice: 0.4307 | IoU: 0.2554 | Tversky: 0.4066 | Hausdorff: 536.8608 | HD95: 72.0105 | LR: 0.001000
2025-07-23 04:09:17 INFO Epoch 031 | Train Loss: 0.7245 | Val Loss: 0.7948 | Dice: 0.4275 | clDice: 0.4437 | IoU: 0.2721 | Tversky: 0.4275 | Hausdorff: 521.0332 | HD95: 94.3424 | LR: 0.001000
2025-07-23 04:12:13 INFO Epoch 032 | Train Loss: 0.7253 | Val Loss: 0.8107 | Dice: 0.3726 | clDice: 0.3891 | IoU: 0.2291 | Tversky: 0.3726 | Hausdorff: 538.9358 | HD95: 78.3800 | LR: 0.001000
2025-07-23 04:15:12 INFO Early stopping at epoch 33 | Best Dice: 0.4721 at epoch 23
2025-07-23 04:15:43 INFO Test Loss: 0.7227 | Dice: 0.4581 | clDice: 0.4928 | IoU: 0.2974 | Tversky: 0.4581 | Hausdorff: 526.0772 | HD95: 52.1893
