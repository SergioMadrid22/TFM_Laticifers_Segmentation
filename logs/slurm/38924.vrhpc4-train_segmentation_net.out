/data/smadper@alumno.upv.es/TFM/env/lib/python3.8/site-packages/albumentations/__init__.py:13: UserWarning: A new version of Albumentations is available: 2.0.8 (you have 1.4.18). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.
  check_for_updates()
2025-07-20 22:46:48 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_resnet18', 'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 2, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'image_size': [512, 512], 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 10, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'sato': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/sato_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 50, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints', 'log_interval': 1, 'patience': 10, 'experiment_name': 'unet_sato_resnet18_dropout', 'timestamp': '20250720_224648'}, 'test': {'batch_size': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/results'}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 0.5, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-20 22:46:48 INFO Experiment name: unet_sato_resnet18_dropout
2025-07-20 22:46:48 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_resnet18', 'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 2, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
/data/smadper@alumno.upv.es/TFM/src/datasets.py:240: UserWarning: Argument 'alpha_affine' is not valid and will be ignored.
  A.ElasticTransform(alpha=120, sigma=120 * 0.05, alpha_affine=120 * 0.03, p=0.3),
2025-07-20 22:47:25 INFO Epoch 001 | Train Loss: 0.7052 | Val Loss: 0.8318 | Dice: 0.0833 | clDice: 0.0469 |IoU: 0.0443 | LR: 0.001000
2025-07-20 22:47:59 INFO Epoch 002 | Train Loss: 0.5774 | Val Loss: 0.5275 | Dice: 0.1823 | clDice: 0.1479 |IoU: 0.1008 | LR: 0.001000
2025-07-20 22:48:33 INFO Epoch 003 | Train Loss: 0.5442 | Val Loss: 0.5567 | Dice: 0.0510 | clDice: 0.0744 |IoU: 0.0268 | LR: 0.001000
2025-07-20 22:49:06 INFO Epoch 004 | Train Loss: 0.5262 | Val Loss: 0.4846 | Dice: 0.2688 | clDice: 0.3158 |IoU: 0.1554 | LR: 0.001000
2025-07-20 22:49:41 INFO Epoch 005 | Train Loss: 0.5202 | Val Loss: 0.4475 | Dice: 0.3429 | clDice: 0.3806 |IoU: 0.2070 | LR: 0.001000
2025-07-20 22:50:10 INFO Epoch 006 | Train Loss: 0.5135 | Val Loss: 0.4362 | Dice: 0.3499 | clDice: 0.3824 |IoU: 0.2122 | LR: 0.001000
2025-07-20 22:50:41 INFO Epoch 007 | Train Loss: 0.5023 | Val Loss: 0.4421 | Dice: 0.3770 | clDice: 0.4318 |IoU: 0.2326 | LR: 0.001000
2025-07-20 22:51:14 INFO Epoch 008 | Train Loss: 0.4991 | Val Loss: 0.6142 | Dice: 0.1683 | clDice: 0.2413 |IoU: 0.0952 | LR: 0.001000
2025-07-20 22:51:49 INFO Epoch 009 | Train Loss: 0.5009 | Val Loss: 0.4093 | Dice: 0.4142 | clDice: 0.4746 |IoU: 0.2613 | LR: 0.001000
2025-07-20 22:52:23 INFO Epoch 010 | Train Loss: 0.4850 | Val Loss: 0.4102 | Dice: 0.4069 | clDice: 0.4708 |IoU: 0.2556 | LR: 0.001000
2025-07-20 22:52:53 INFO Epoch 011 | Train Loss: 0.4809 | Val Loss: 0.4154 | Dice: 0.4012 | clDice: 0.4506 |IoU: 0.2511 | LR: 0.001000
2025-07-20 22:53:25 INFO Epoch 012 | Train Loss: 0.4802 | Val Loss: 0.3982 | Dice: 0.4182 | clDice: 0.4620 |IoU: 0.2647 | LR: 0.001000
2025-07-20 22:53:59 INFO Epoch 013 | Train Loss: 0.4810 | Val Loss: 0.4109 | Dice: 0.3947 | clDice: 0.4434 |IoU: 0.2460 | LR: 0.001000
2025-07-20 22:54:31 INFO Epoch 014 | Train Loss: 0.4781 | Val Loss: 0.3899 | Dice: 0.4270 | clDice: 0.4712 |IoU: 0.2715 | LR: 0.001000
2025-07-20 22:55:02 INFO Epoch 015 | Train Loss: 0.4768 | Val Loss: 0.3980 | Dice: 0.4234 | clDice: 0.4724 |IoU: 0.2687 | LR: 0.001000
2025-07-20 22:55:32 INFO Epoch 016 | Train Loss: 0.4748 | Val Loss: 0.3910 | Dice: 0.4349 | clDice: 0.4843 |IoU: 0.2781 | LR: 0.001000
2025-07-20 22:56:08 INFO Epoch 017 | Train Loss: 0.4794 | Val Loss: 0.3971 | Dice: 0.4354 | clDice: 0.4877 |IoU: 0.2783 | LR: 0.001000
2025-07-20 22:56:42 INFO Epoch 018 | Train Loss: 0.4789 | Val Loss: 0.3816 | Dice: 0.4314 | clDice: 0.4662 |IoU: 0.2751 | LR: 0.001000
2025-07-20 22:57:17 INFO Epoch 019 | Train Loss: 0.4669 | Val Loss: 0.3806 | Dice: 0.4323 | clDice: 0.4745 |IoU: 0.2758 | LR: 0.001000
2025-07-20 22:57:50 INFO Epoch 020 | Train Loss: 0.4740 | Val Loss: 0.3807 | Dice: 0.4369 | clDice: 0.4831 |IoU: 0.2797 | LR: 0.001000
2025-07-20 22:58:25 INFO Epoch 021 | Train Loss: 0.4753 | Val Loss: 0.3965 | Dice: 0.4338 | clDice: 0.4829 |IoU: 0.2770 | LR: 0.001000
2025-07-20 22:58:55 INFO Epoch 022 | Train Loss: 0.4661 | Val Loss: 0.3798 | Dice: 0.4400 | clDice: 0.4879 |IoU: 0.2821 | LR: 0.001000
2025-07-20 22:59:28 INFO Epoch 023 | Train Loss: 0.4755 | Val Loss: 0.3943 | Dice: 0.4324 | clDice: 0.4814 |IoU: 0.2760 | LR: 0.001000
2025-07-20 23:00:03 INFO Epoch 024 | Train Loss: 0.4845 | Val Loss: 0.3782 | Dice: 0.4304 | clDice: 0.4689 |IoU: 0.2742 | LR: 0.001000
2025-07-20 23:00:35 INFO Epoch 025 | Train Loss: 0.4699 | Val Loss: 0.3829 | Dice: 0.4502 | clDice: 0.4953 |IoU: 0.2905 | LR: 0.001000
2025-07-20 23:01:08 INFO Epoch 026 | Train Loss: 0.4688 | Val Loss: 0.3750 | Dice: 0.4513 | clDice: 0.5072 |IoU: 0.2915 | LR: 0.001000
2025-07-20 23:01:44 INFO Epoch 027 | Train Loss: 0.4707 | Val Loss: 0.3747 | Dice: 0.4499 | clDice: 0.4823 |IoU: 0.2905 | LR: 0.001000
2025-07-20 23:02:17 INFO Epoch 028 | Train Loss: 0.4650 | Val Loss: 0.3982 | Dice: 0.4294 | clDice: 0.4859 |IoU: 0.2735 | LR: 0.001000
2025-07-20 23:02:52 INFO Epoch 029 | Train Loss: 0.4673 | Val Loss: 0.3702 | Dice: 0.4548 | clDice: 0.5056 |IoU: 0.2944 | LR: 0.001000
2025-07-20 23:03:22 INFO Epoch 030 | Train Loss: 0.4714 | Val Loss: 0.4106 | Dice: 0.4101 | clDice: 0.4640 |IoU: 0.2581 | LR: 0.001000
2025-07-20 23:03:55 INFO Epoch 031 | Train Loss: 0.4641 | Val Loss: 0.3897 | Dice: 0.4527 | clDice: 0.4867 |IoU: 0.2928 | LR: 0.001000
2025-07-20 23:04:29 INFO Epoch 032 | Train Loss: 0.4664 | Val Loss: 0.3781 | Dice: 0.4370 | clDice: 0.4646 |IoU: 0.2799 | LR: 0.001000
2025-07-20 23:05:01 INFO Epoch 033 | Train Loss: 0.4672 | Val Loss: 0.3712 | Dice: 0.4592 | clDice: 0.4943 |IoU: 0.2982 | LR: 0.001000
2025-07-20 23:05:36 INFO Epoch 034 | Train Loss: 0.4664 | Val Loss: 0.3715 | Dice: 0.4540 | clDice: 0.5007 |IoU: 0.2938 | LR: 0.001000
2025-07-20 23:06:06 INFO Epoch 035 | Train Loss: 0.4670 | Val Loss: 0.3755 | Dice: 0.4362 | clDice: 0.4662 |IoU: 0.2791 | LR: 0.001000
2025-07-20 23:06:36 INFO Epoch 036 | Train Loss: 0.4676 | Val Loss: 0.3784 | Dice: 0.4445 | clDice: 0.5052 |IoU: 0.2860 | LR: 0.001000
2025-07-20 23:07:11 INFO Epoch 037 | Train Loss: 0.4671 | Val Loss: 0.3820 | Dice: 0.4412 | clDice: 0.4885 |IoU: 0.2832 | LR: 0.001000
2025-07-20 23:07:44 INFO Epoch 038 | Train Loss: 0.4698 | Val Loss: 0.3689 | Dice: 0.4555 | clDice: 0.4906 |IoU: 0.2951 | LR: 0.001000
2025-07-20 23:08:19 INFO Epoch 039 | Train Loss: 0.4599 | Val Loss: 0.3810 | Dice: 0.4548 | clDice: 0.4882 |IoU: 0.2945 | LR: 0.001000
2025-07-20 23:08:53 INFO Epoch 040 | Train Loss: 0.4648 | Val Loss: 0.3633 | Dice: 0.4584 | clDice: 0.4836 |IoU: 0.2975 | LR: 0.001000
2025-07-20 23:09:23 INFO Epoch 041 | Train Loss: 0.4635 | Val Loss: 0.3757 | Dice: 0.4452 | clDice: 0.4808 |IoU: 0.2866 | LR: 0.001000
2025-07-20 23:09:56 INFO Epoch 042 | Train Loss: 0.4598 | Val Loss: 0.3748 | Dice: 0.4572 | clDice: 0.5052 |IoU: 0.2965 | LR: 0.001000
2025-07-20 23:10:30 INFO Epoch 043 | Train Loss: 0.4586 | Val Loss: 0.3884 | Dice: 0.4401 | clDice: 0.4947 |IoU: 0.2823 | LR: 0.001000
2025-07-20 23:11:01 INFO Epoch 044 | Train Loss: 0.4624 | Val Loss: 0.3584 | Dice: 0.4603 | clDice: 0.5033 |IoU: 0.2993 | LR: 0.001000
2025-07-20 23:11:32 INFO Epoch 045 | Train Loss: 0.4628 | Val Loss: 0.3679 | Dice: 0.4604 | clDice: 0.5003 |IoU: 0.2992 | LR: 0.001000
2025-07-20 23:12:06 INFO Epoch 046 | Train Loss: 0.4646 | Val Loss: 0.3697 | Dice: 0.4644 | clDice: 0.5148 |IoU: 0.3026 | LR: 0.001000
2025-07-20 23:12:39 INFO Epoch 047 | Train Loss: 0.4683 | Val Loss: 0.3771 | Dice: 0.4487 | clDice: 0.4877 |IoU: 0.2895 | LR: 0.001000
2025-07-20 23:13:13 INFO Epoch 048 | Train Loss: 0.4714 | Val Loss: 0.3793 | Dice: 0.4603 | clDice: 0.5103 |IoU: 0.2991 | LR: 0.001000
2025-07-20 23:13:47 INFO Epoch 049 | Train Loss: 0.4635 | Val Loss: 0.3646 | Dice: 0.4645 | clDice: 0.5003 |IoU: 0.3028 | LR: 0.001000
2025-07-20 23:14:18 INFO Epoch 050 | Train Loss: 0.4656 | Val Loss: 0.3727 | Dice: 0.4625 | clDice: 0.5146 |IoU: 0.3010 | LR: 0.001000
2025-07-20 23:14:18 INFO Training completed.
2025-07-20 23:14:32 INFO Test Loss: 0.3584 | Dice: 0.4603 | IoU: 0.2993 | clDice: 0.5033
