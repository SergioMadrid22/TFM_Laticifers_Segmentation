2025-07-23 08:35:24 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_083524_unet_timm-resnest50d_hausdorff_dice', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_timm-resnest50d_hausdorff_dice', 'timestamp': '20250723_083524'}, 'test': {'batch_size': 1}, 'loss': {'name': 'hausdorff', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 08:35:24 INFO Experiment name: unet_timm-resnest50d_hausdorff_dice
2025-07-23 08:35:24 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 08:35:25 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 08:35:25 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 08:35:25 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 08:35:25 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 08:37:50 INFO Epoch 001 | Train Loss: 17.6188 | Val Loss: 9.7104 | Dice: 0.3372 | clDice: 0.3638 | IoU: 0.2031 | Tversky: 0.3372 | Hausdorff: 447.8152 | HD95: 169.3220 | LR: 0.001000
2025-07-23 08:40:14 INFO Epoch 002 | Train Loss: 13.2412 | Val Loss: 8.8324 | Dice: 0.3660 | clDice: 0.3925 | IoU: 0.2241 | Tversky: 0.3660 | Hausdorff: 313.7884 | HD95: 120.8316 | LR: 0.001000
2025-07-23 08:42:39 INFO Epoch 003 | Train Loss: 13.1323 | Val Loss: 8.8174 | Dice: 0.4398 | clDice: 0.4859 | IoU: 0.2822 | Tversky: 0.4398 | Hausdorff: 290.5574 | HD95: 63.2960 | LR: 0.001000
2025-07-23 08:45:02 INFO Epoch 004 | Train Loss: 13.2151 | Val Loss: 8.6532 | Dice: 0.3691 | clDice: 0.3945 | IoU: 0.2264 | Tversky: 0.3691 | Hausdorff: 308.1881 | HD95: 125.3186 | LR: 0.001000
2025-07-23 08:47:29 INFO Epoch 005 | Train Loss: 13.1980 | Val Loss: 8.6199 | Dice: 0.3517 | clDice: 0.3727 | IoU: 0.2139 | Tversky: 0.3517 | Hausdorff: 392.4544 | HD95: 137.8132 | LR: 0.001000
2025-07-23 08:50:01 INFO Epoch 006 | Train Loss: 13.0200 | Val Loss: 8.5989 | Dice: 0.4155 | clDice: 0.4501 | IoU: 0.2632 | Tversky: 0.4155 | Hausdorff: 418.9195 | HD95: 100.0574 | LR: 0.001000
2025-07-23 08:52:33 INFO Epoch 007 | Train Loss: 13.0563 | Val Loss: 8.6036 | Dice: 0.3677 | clDice: 0.3957 | IoU: 0.2253 | Tversky: 0.3677 | Hausdorff: 444.8280 | HD95: 166.9998 | LR: 0.001000
2025-07-23 08:54:52 INFO Epoch 008 | Train Loss: 12.9307 | Val Loss: 8.5754 | Dice: 0.3736 | clDice: 0.3993 | IoU: 0.2299 | Tversky: 0.3736 | Hausdorff: 505.9430 | HD95: 182.4705 | LR: 0.001000
2025-07-23 08:57:17 INFO Epoch 009 | Train Loss: 13.0315 | Val Loss: 8.5757 | Dice: 0.3620 | clDice: 0.3830 | IoU: 0.2211 | Tversky: 0.3620 | Hausdorff: 504.3191 | HD95: 160.0512 | LR: 0.001000
2025-07-23 08:59:46 INFO Epoch 010 | Train Loss: 12.9302 | Val Loss: 8.6106 | Dice: 0.3612 | clDice: 0.3839 | IoU: 0.2209 | Tversky: 0.3612 | Hausdorff: 478.3027 | HD95: 187.5065 | LR: 0.001000
2025-07-23 09:02:13 INFO Epoch 011 | Train Loss: 12.9993 | Val Loss: 8.5970 | Dice: 0.3870 | clDice: 0.4178 | IoU: 0.2399 | Tversky: 0.3870 | Hausdorff: 468.2760 | HD95: 159.3975 | LR: 0.001000
2025-07-23 09:04:42 INFO Epoch 012 | Train Loss: 13.1044 | Val Loss: 8.5684 | Dice: 0.3805 | clDice: 0.4069 | IoU: 0.2358 | Tversky: 0.3805 | Hausdorff: 484.1309 | HD95: 156.2618 | LR: 0.001000
2025-07-23 09:07:03 INFO Epoch 013 | Train Loss: 12.9403 | Val Loss: 8.5500 | Dice: 0.4217 | clDice: 0.4612 | IoU: 0.2677 | Tversky: 0.4217 | Hausdorff: 439.6179 | HD95: 120.3974 | LR: 0.001000
2025-07-23 09:09:31 INFO Epoch 014 | Train Loss: 12.9984 | Val Loss: 8.4361 | Dice: 0.3550 | clDice: 0.3807 | IoU: 0.2162 | Tversky: 0.3550 | Hausdorff: 522.1299 | HD95: 181.4417 | LR: 0.001000
2025-07-23 09:12:04 INFO Epoch 015 | Train Loss: 12.9474 | Val Loss: 8.5570 | Dice: 0.4312 | clDice: 0.4678 | IoU: 0.2754 | Tversky: 0.4312 | Hausdorff: 314.2144 | HD95: 90.5143 | LR: 0.001000
2025-07-23 09:14:27 INFO Epoch 016 | Train Loss: 13.0799 | Val Loss: 8.5700 | Dice: 0.3675 | clDice: 0.3941 | IoU: 0.2252 | Tversky: 0.3675 | Hausdorff: 409.2464 | HD95: 175.0953 | LR: 0.001000
2025-07-23 09:16:45 INFO Epoch 017 | Train Loss: 13.0408 | Val Loss: 8.5479 | Dice: 0.4004 | clDice: 0.4269 | IoU: 0.2508 | Tversky: 0.4004 | Hausdorff: 355.7619 | HD95: 112.4838 | LR: 0.001000
2025-07-23 09:19:00 INFO Epoch 018 | Train Loss: 12.7901 | Val Loss: 8.6325 | Dice: 0.2806 | clDice: 0.2925 | IoU: 0.1640 | Tversky: 0.2806 | Hausdorff: 559.3353 | HD95: 238.1850 | LR: 0.001000
2025-07-23 09:21:21 INFO Epoch 019 | Train Loss: 12.8550 | Val Loss: 8.5409 | Dice: 0.3943 | clDice: 0.4254 | IoU: 0.2457 | Tversky: 0.3943 | Hausdorff: 419.4287 | HD95: 130.9639 | LR: 0.001000
2025-07-23 09:23:38 INFO Epoch 020 | Train Loss: 13.0009 | Val Loss: 8.7731 | Dice: 0.1726 | clDice: 0.1750 | IoU: 0.0948 | Tversky: 0.1726 | Hausdorff: 559.1982 | HD95: 273.5601 | LR: 0.001000
2025-07-23 09:25:50 INFO Epoch 021 | Train Loss: 12.7216 | Val Loss: 8.5942 | Dice: 0.3570 | clDice: 0.3809 | IoU: 0.2189 | Tversky: 0.3570 | Hausdorff: 443.6502 | HD95: 152.7773 | LR: 0.001000
2025-07-23 09:28:04 INFO Epoch 022 | Train Loss: 13.0618 | Val Loss: 8.1844 | Dice: 0.4213 | clDice: 0.4577 | IoU: 0.2672 | Tversky: 0.4213 | Hausdorff: 331.5045 | HD95: 104.9958 | LR: 0.001000
2025-07-23 09:30:16 INFO Epoch 023 | Train Loss: 13.0305 | Val Loss: 8.5589 | Dice: 0.3662 | clDice: 0.3918 | IoU: 0.2247 | Tversky: 0.3662 | Hausdorff: 439.4943 | HD95: 150.0786 | LR: 0.001000
2025-07-23 09:32:35 INFO Epoch 024 | Train Loss: 12.7475 | Val Loss: 8.5448 | Dice: 0.4085 | clDice: 0.4407 | IoU: 0.2577 | Tversky: 0.4085 | Hausdorff: 389.2187 | HD95: 122.4160 | LR: 0.001000
2025-07-23 09:34:51 INFO Epoch 025 | Train Loss: 13.0985 | Val Loss: 8.5187 | Dice: 0.4266 | clDice: 0.4689 | IoU: 0.2715 | Tversky: 0.4266 | Hausdorff: 398.1606 | HD95: 124.7437 | LR: 0.001000
2025-07-23 09:37:03 INFO Epoch 026 | Train Loss: 12.8132 | Val Loss: 8.5385 | Dice: 0.4199 | clDice: 0.4506 | IoU: 0.2660 | Tversky: 0.4199 | Hausdorff: 349.6128 | HD95: 95.9199 | LR: 0.001000
2025-07-23 09:39:17 INFO Epoch 027 | Train Loss: 12.9758 | Val Loss: 8.5319 | Dice: 0.4157 | clDice: 0.4464 | IoU: 0.2626 | Tversky: 0.4157 | Hausdorff: 318.3198 | HD95: 97.4565 | LR: 0.001000
2025-07-23 09:41:33 INFO Epoch 028 | Train Loss: 13.0007 | Val Loss: 8.5660 | Dice: 0.4055 | clDice: 0.4318 | IoU: 0.2545 | Tversky: 0.4055 | Hausdorff: 373.4782 | HD95: 93.2686 | LR: 0.001000
2025-07-23 09:43:52 INFO Epoch 029 | Train Loss: 12.9865 | Val Loss: 8.5491 | Dice: 0.4177 | clDice: 0.4472 | IoU: 0.2642 | Tversky: 0.4177 | Hausdorff: 312.6172 | HD95: 103.5347 | LR: 0.001000
2025-07-23 09:46:06 INFO Epoch 030 | Train Loss: 13.0035 | Val Loss: 8.5411 | Dice: 0.4135 | clDice: 0.4435 | IoU: 0.2613 | Tversky: 0.4135 | Hausdorff: 390.4500 | HD95: 96.6925 | LR: 0.001000
2025-07-23 09:48:21 INFO Epoch 031 | Train Loss: 12.6743 | Val Loss: 5.5660 | Dice: 0.4519 | clDice: 0.4972 | IoU: 0.2925 | Tversky: 0.4519 | Hausdorff: 280.0550 | HD95: 72.7472 | LR: 0.001000
2025-07-23 09:50:35 INFO Epoch 032 | Train Loss: 12.9511 | Val Loss: 8.5198 | Dice: 0.4311 | clDice: 0.4662 | IoU: 0.2751 | Tversky: 0.4311 | Hausdorff: 286.1077 | HD95: 84.7309 | LR: 0.001000
2025-07-23 09:52:52 INFO Epoch 033 | Train Loss: 12.9514 | Val Loss: 8.5276 | Dice: 0.4072 | clDice: 0.4389 | IoU: 0.2559 | Tversky: 0.4072 | Hausdorff: 397.9441 | HD95: 112.5338 | LR: 0.001000
2025-07-23 09:55:14 INFO Epoch 034 | Train Loss: 12.8545 | Val Loss: 8.4344 | Dice: 0.3617 | clDice: 0.3869 | IoU: 0.2215 | Tversky: 0.3617 | Hausdorff: 461.2843 | HD95: 153.5817 | LR: 0.001000
2025-07-23 09:57:29 INFO Epoch 035 | Train Loss: 13.2093 | Val Loss: 8.3838 | Dice: 0.4189 | clDice: 0.4508 | IoU: 0.2657 | Tversky: 0.4189 | Hausdorff: 410.2323 | HD95: 97.3831 | LR: 0.001000
2025-07-23 09:59:43 INFO Epoch 036 | Train Loss: 12.8451 | Val Loss: 8.5440 | Dice: 0.3899 | clDice: 0.4180 | IoU: 0.2426 | Tversky: 0.3899 | Hausdorff: 394.5543 | HD95: 123.0243 | LR: 0.001000
2025-07-23 10:02:02 INFO Epoch 037 | Train Loss: 12.9474 | Val Loss: 8.5296 | Dice: 0.4064 | clDice: 0.4356 | IoU: 0.2554 | Tversky: 0.4064 | Hausdorff: 315.9460 | HD95: 113.0126 | LR: 0.001000
2025-07-23 10:04:21 INFO Epoch 038 | Train Loss: 12.9509 | Val Loss: 8.5363 | Dice: 0.3992 | clDice: 0.4269 | IoU: 0.2498 | Tversky: 0.3992 | Hausdorff: 364.4876 | HD95: 126.4957 | LR: 0.001000
2025-07-23 10:06:38 INFO Epoch 039 | Train Loss: 12.9369 | Val Loss: 8.5279 | Dice: 0.4418 | clDice: 0.4780 | IoU: 0.2841 | Tversky: 0.4418 | Hausdorff: 286.7895 | HD95: 84.4710 | LR: 0.001000
2025-07-23 10:08:55 INFO Epoch 040 | Train Loss: 12.7655 | Val Loss: 8.5333 | Dice: 0.4184 | clDice: 0.4488 | IoU: 0.2651 | Tversky: 0.4184 | Hausdorff: 339.8008 | HD95: 95.5304 | LR: 0.001000
2025-07-23 10:11:14 INFO Early stopping at epoch 41 | Best Dice: 0.4519 at epoch 31
2025-07-23 10:11:55 INFO Test Loss: 5.5660 | Dice: 0.4519 | clDice: 0.4972 | IoU: 0.2925 | Tversky: 0.4519 | Hausdorff: 280.0550 | HD95: 72.7472
