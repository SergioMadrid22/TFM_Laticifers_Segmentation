2025-07-23 05:39:25 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_053925_unet_densenet121_clahe', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_densenet121_clahe', 'timestamp': '20250723_053925'}, 'test': {'batch_size': 1}, 'loss': {'name': 'hausdorff', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 05:39:25 INFO Experiment name: unet_densenet121_clahe
2025-07-23 05:39:25 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 05:39:26 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 05:39:26 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 05:39:26 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 05:39:26 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 05:41:49 INFO Epoch 001 | Train Loss: 17.5083 | Val Loss: 9.3618 | Dice: 0.3144 | clDice: 0.3387 | IoU: 0.1867 | Tversky: 0.3144 | Hausdorff: 581.1594 | HD95: 235.1404 | LR: 0.001000
2025-07-23 05:44:08 INFO Epoch 002 | Train Loss: 13.2709 | Val Loss: 8.8232 | Dice: 0.3685 | clDice: 0.3969 | IoU: 0.2260 | Tversky: 0.3685 | Hausdorff: 400.0734 | HD95: 132.7861 | LR: 0.001000
2025-07-23 05:46:27 INFO Epoch 003 | Train Loss: 13.0876 | Val Loss: 8.7679 | Dice: 0.2766 | clDice: 0.3014 | IoU: 0.1624 | Tversky: 0.2766 | Hausdorff: 547.9535 | HD95: 237.5443 | LR: 0.001000
2025-07-23 05:48:46 INFO Epoch 004 | Train Loss: 13.2604 | Val Loss: 8.6476 | Dice: 0.3890 | clDice: 0.4243 | IoU: 0.2423 | Tversky: 0.3890 | Hausdorff: 340.8054 | HD95: 126.7473 | LR: 0.001000
2025-07-23 05:51:05 INFO Epoch 005 | Train Loss: 13.1514 | Val Loss: 8.6098 | Dice: 0.4368 | clDice: 0.4768 | IoU: 0.2799 | Tversky: 0.4368 | Hausdorff: 285.4588 | HD95: 75.3946 | LR: 0.001000
2025-07-23 05:53:25 INFO Epoch 006 | Train Loss: 13.0681 | Val Loss: 8.6026 | Dice: 0.3700 | clDice: 0.4000 | IoU: 0.2271 | Tversky: 0.3700 | Hausdorff: 491.1269 | HD95: 158.7757 | LR: 0.001000
2025-07-23 05:55:44 INFO Epoch 007 | Train Loss: 13.0530 | Val Loss: 8.5770 | Dice: 0.3855 | clDice: 0.4139 | IoU: 0.2389 | Tversky: 0.3855 | Hausdorff: 559.7035 | HD95: 167.9443 | LR: 0.001000
2025-07-23 05:57:56 INFO Epoch 008 | Train Loss: 12.9623 | Val Loss: 8.5820 | Dice: 0.3911 | clDice: 0.4219 | IoU: 0.2435 | Tversky: 0.3911 | Hausdorff: 458.7580 | HD95: 130.7818 | LR: 0.001000
2025-07-23 06:00:14 INFO Epoch 009 | Train Loss: 13.0503 | Val Loss: 8.6399 | Dice: 0.4038 | clDice: 0.4338 | IoU: 0.2545 | Tversky: 0.4038 | Hausdorff: 337.3420 | HD95: 94.9969 | LR: 0.001000
2025-07-23 06:02:34 INFO Epoch 010 | Train Loss: 12.9215 | Val Loss: 8.5714 | Dice: 0.3956 | clDice: 0.4257 | IoU: 0.2472 | Tversky: 0.3956 | Hausdorff: 396.6870 | HD95: 120.9416 | LR: 0.001000
2025-07-23 06:04:55 INFO Epoch 011 | Train Loss: 13.0440 | Val Loss: 8.5802 | Dice: 0.3568 | clDice: 0.3806 | IoU: 0.2172 | Tversky: 0.3568 | Hausdorff: 496.9698 | HD95: 193.9890 | LR: 0.001000
2025-07-23 06:07:18 INFO Epoch 012 | Train Loss: 13.1371 | Val Loss: 8.6088 | Dice: 0.3306 | clDice: 0.3563 | IoU: 0.1997 | Tversky: 0.3306 | Hausdorff: 561.2116 | HD95: 245.0283 | LR: 0.001000
2025-07-23 06:09:35 INFO Epoch 013 | Train Loss: 12.9772 | Val Loss: 8.5598 | Dice: 0.4229 | clDice: 0.4583 | IoU: 0.2691 | Tversky: 0.4229 | Hausdorff: 374.3313 | HD95: 113.1437 | LR: 0.001000
2025-07-23 06:11:58 INFO Epoch 014 | Train Loss: 12.9610 | Val Loss: 8.5386 | Dice: 0.4132 | clDice: 0.4440 | IoU: 0.2611 | Tversky: 0.4132 | Hausdorff: 401.3938 | HD95: 119.0161 | LR: 0.001000
2025-07-23 06:14:23 INFO Epoch 015 | Train Loss: 12.9820 | Val Loss: 8.5496 | Dice: 0.3996 | clDice: 0.4297 | IoU: 0.2500 | Tversky: 0.3996 | Hausdorff: 448.2850 | HD95: 138.3694 | LR: 0.001000
2025-07-23 06:16:47 INFO Epoch 016 | Train Loss: 13.0550 | Val Loss: 8.5407 | Dice: 0.4333 | clDice: 0.4704 | IoU: 0.2768 | Tversky: 0.4333 | Hausdorff: 293.8432 | HD95: 102.5788 | LR: 0.001000
2025-07-23 06:19:02 INFO Epoch 017 | Train Loss: 13.0214 | Val Loss: 8.6457 | Dice: 0.2904 | clDice: 0.3115 | IoU: 0.1699 | Tversky: 0.2904 | Hausdorff: 497.4977 | HD95: 167.1610 | LR: 0.001000
2025-07-23 06:21:18 INFO Epoch 018 | Train Loss: 12.9126 | Val Loss: 8.6229 | Dice: 0.2915 | clDice: 0.3082 | IoU: 0.1710 | Tversky: 0.2915 | Hausdorff: 518.9824 | HD95: 203.9410 | LR: 0.001000
2025-07-23 06:23:38 INFO Epoch 019 | Train Loss: 11.3234 | Val Loss: 5.8394 | Dice: 0.3140 | clDice: 0.3369 | IoU: 0.1866 | Tversky: 0.3140 | Hausdorff: 644.1598 | HD95: 177.9333 | LR: 0.001000
2025-07-23 06:26:02 INFO Epoch 020 | Train Loss: 12.5165 | Val Loss: 7.2535 | Dice: 0.3215 | clDice: 0.3456 | IoU: 0.1920 | Tversky: 0.3215 | Hausdorff: 548.9720 | HD95: 220.6595 | LR: 0.001000
2025-07-23 06:28:16 INFO Epoch 021 | Train Loss: 12.5682 | Val Loss: 8.5809 | Dice: 0.3783 | clDice: 0.4082 | IoU: 0.2336 | Tversky: 0.3783 | Hausdorff: 346.0407 | HD95: 130.9656 | LR: 0.001000
2025-07-23 06:30:32 INFO Epoch 022 | Train Loss: 12.8286 | Val Loss: 8.5062 | Dice: 0.3643 | clDice: 0.3950 | IoU: 0.2240 | Tversky: 0.3643 | Hausdorff: 537.0591 | HD95: 204.4171 | LR: 0.001000
2025-07-23 06:32:48 INFO Epoch 023 | Train Loss: 13.0325 | Val Loss: 8.5541 | Dice: 0.3743 | clDice: 0.4006 | IoU: 0.2311 | Tversky: 0.3743 | Hausdorff: 459.0696 | HD95: 135.5490 | LR: 0.001000
2025-07-23 06:35:10 INFO Epoch 024 | Train Loss: 12.7899 | Val Loss: 8.5477 | Dice: 0.3875 | clDice: 0.4135 | IoU: 0.2406 | Tversky: 0.3875 | Hausdorff: 415.2719 | HD95: 133.6596 | LR: 0.001000
2025-07-23 06:37:36 INFO Epoch 025 | Train Loss: 13.0880 | Val Loss: 7.8853 | Dice: 0.3797 | clDice: 0.4115 | IoU: 0.2345 | Tversky: 0.3797 | Hausdorff: 513.7009 | HD95: 178.7850 | LR: 0.001000
2025-07-23 06:39:53 INFO Epoch 026 | Train Loss: 12.8358 | Val Loss: 8.5444 | Dice: 0.4261 | clDice: 0.4589 | IoU: 0.2716 | Tversky: 0.4261 | Hausdorff: 279.8524 | HD95: 84.3723 | LR: 0.001000
2025-07-23 06:42:12 INFO Epoch 027 | Train Loss: 12.9234 | Val Loss: 8.5364 | Dice: 0.4280 | clDice: 0.4599 | IoU: 0.2727 | Tversky: 0.4280 | Hausdorff: 418.7519 | HD95: 98.6567 | LR: 0.001000
2025-07-23 06:44:33 INFO Epoch 028 | Train Loss: 13.0246 | Val Loss: 8.5259 | Dice: 0.4228 | clDice: 0.4545 | IoU: 0.2685 | Tversky: 0.4228 | Hausdorff: 334.0649 | HD95: 93.7321 | LR: 0.001000
2025-07-23 06:47:00 INFO Early stopping at epoch 29 | Best Dice: 0.4368 at epoch 19
2025-07-23 06:47:41 INFO Test Loss: 5.8394 | Dice: 0.3140 | clDice: 0.3369 | IoU: 0.1866 | Tversky: 0.3140 | Hausdorff: 644.1598 | HD95: 177.9333
