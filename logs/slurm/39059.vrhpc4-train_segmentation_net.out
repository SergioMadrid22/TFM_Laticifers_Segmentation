2025-07-23 04:49:24 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_044924_unet_timm-resnest50d_clahe_sato_otsu', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_timm-resnest50d_clahe_sato_otsu', 'timestamp': '20250723_044924'}, 'test': {'batch_size': 1}, 'loss': {'name': 'hausdorff', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 04:49:24 INFO Experiment name: unet_timm-resnest50d_clahe_sato_otsu
2025-07-23 04:49:24 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 04:49:24 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 04:49:25 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 04:49:25 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 04:49:25 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 04:51:50 INFO Epoch 001 | Train Loss: 17.4629 | Val Loss: 9.4293 | Dice: 0.2950 | clDice: 0.3113 | IoU: 0.1733 | Tversky: 0.2950 | Hausdorff: 409.3039 | HD95: 170.2884 | LR: 0.001000
2025-07-23 04:54:15 INFO Epoch 002 | Train Loss: 13.2428 | Val Loss: 8.8389 | Dice: 0.4079 | clDice: 0.4429 | IoU: 0.2565 | Tversky: 0.4079 | Hausdorff: 306.4586 | HD95: 90.0261 | LR: 0.001000
2025-07-23 04:56:41 INFO Epoch 003 | Train Loss: 13.2009 | Val Loss: 8.7111 | Dice: 0.3586 | clDice: 0.3854 | IoU: 0.2186 | Tversky: 0.3586 | Hausdorff: 373.4580 | HD95: 118.7527 | LR: 0.001000
2025-07-23 04:59:06 INFO Epoch 004 | Train Loss: 13.2518 | Val Loss: 8.6421 | Dice: 0.3960 | clDice: 0.4313 | IoU: 0.2473 | Tversky: 0.3960 | Hausdorff: 355.6226 | HD95: 123.5912 | LR: 0.001000
2025-07-23 05:01:31 INFO Epoch 005 | Train Loss: 13.2010 | Val Loss: 8.6070 | Dice: 0.3906 | clDice: 0.4178 | IoU: 0.2430 | Tversky: 0.3906 | Hausdorff: 423.9449 | HD95: 129.8047 | LR: 0.001000
2025-07-23 05:03:55 INFO Epoch 006 | Train Loss: 12.9783 | Val Loss: 8.5911 | Dice: 0.3892 | clDice: 0.4190 | IoU: 0.2418 | Tversky: 0.3892 | Hausdorff: 347.5214 | HD95: 115.5411 | LR: 0.001000
2025-07-23 05:06:20 INFO Epoch 007 | Train Loss: 12.9555 | Val Loss: 8.5605 | Dice: 0.2987 | clDice: 0.3163 | IoU: 0.1773 | Tversky: 0.2987 | Hausdorff: 604.0295 | HD95: 263.9824 | LR: 0.001000
2025-07-23 05:08:35 INFO Epoch 008 | Train Loss: 13.0284 | Val Loss: 8.6731 | Dice: 0.2513 | clDice: 0.2656 | IoU: 0.1449 | Tversky: 0.2513 | Hausdorff: 622.8077 | HD95: 290.6968 | LR: 0.001000
2025-07-23 05:10:53 INFO Epoch 009 | Train Loss: 13.1272 | Val Loss: 8.7131 | Dice: 0.2784 | clDice: 0.2909 | IoU: 0.1632 | Tversky: 0.2784 | Hausdorff: 577.8281 | HD95: 316.7492 | LR: 0.001000
2025-07-23 05:13:12 INFO Epoch 010 | Train Loss: 13.0466 | Val Loss: 8.6031 | Dice: 0.3897 | clDice: 0.4198 | IoU: 0.2426 | Tversky: 0.3897 | Hausdorff: 514.1100 | HD95: 159.2984 | LR: 0.001000
2025-07-23 05:15:32 INFO Epoch 011 | Train Loss: 13.0790 | Val Loss: 7.9656 | Dice: 0.3909 | clDice: 0.4269 | IoU: 0.2433 | Tversky: 0.3909 | Hausdorff: 359.4926 | HD95: 130.1177 | LR: 0.001000
2025-07-23 05:17:51 INFO Epoch 012 | Train Loss: 13.0687 | Val Loss: 8.6329 | Dice: 0.3180 | clDice: 0.3368 | IoU: 0.1891 | Tversky: 0.3180 | Hausdorff: 617.6507 | HD95: 240.0595 | LR: 0.001000
2025-07-23 05:20:04 INFO Epoch 013 | Train Loss: 13.0162 | Val Loss: 8.5769 | Dice: 0.3919 | clDice: 0.4226 | IoU: 0.2445 | Tversky: 0.3919 | Hausdorff: 447.4572 | HD95: 132.0159 | LR: 0.001000
2025-07-23 05:22:21 INFO Epoch 014 | Train Loss: 13.0508 | Val Loss: 8.5813 | Dice: 0.3605 | clDice: 0.3861 | IoU: 0.2199 | Tversky: 0.3605 | Hausdorff: 526.1709 | HD95: 186.9205 | LR: 0.001000
2025-07-23 05:24:40 INFO Epoch 015 | Train Loss: 12.9835 | Val Loss: 8.5723 | Dice: 0.3608 | clDice: 0.3867 | IoU: 0.2205 | Tversky: 0.3608 | Hausdorff: 430.9286 | HD95: 167.4490 | LR: 0.001000
2025-07-23 05:26:59 INFO Epoch 016 | Train Loss: 13.0706 | Val Loss: 8.5710 | Dice: 0.3782 | clDice: 0.4053 | IoU: 0.2333 | Tversky: 0.3782 | Hausdorff: 472.6863 | HD95: 159.1216 | LR: 0.001000
2025-07-23 05:29:11 INFO Epoch 017 | Train Loss: 13.0577 | Val Loss: 8.5470 | Dice: 0.4008 | clDice: 0.4329 | IoU: 0.2510 | Tversky: 0.4008 | Hausdorff: 481.4148 | HD95: 145.8588 | LR: 0.001000
2025-07-23 05:31:23 INFO Epoch 018 | Train Loss: 12.8130 | Val Loss: 8.5695 | Dice: 0.3733 | clDice: 0.3996 | IoU: 0.2296 | Tversky: 0.3733 | Hausdorff: 490.6453 | HD95: 147.0072 | LR: 0.001000
2025-07-23 05:33:39 INFO Epoch 019 | Train Loss: 12.8815 | Val Loss: 8.5435 | Dice: 0.4120 | clDice: 0.4433 | IoU: 0.2598 | Tversky: 0.4120 | Hausdorff: 420.2875 | HD95: 126.5142 | LR: 0.001000
2025-07-23 05:35:57 INFO Epoch 020 | Train Loss: 13.0581 | Val Loss: 8.3055 | Dice: 0.3962 | clDice: 0.4257 | IoU: 0.2472 | Tversky: 0.3962 | Hausdorff: 347.8423 | HD95: 120.3987 | LR: 0.001000
2025-07-23 05:38:16 INFO Early stopping at epoch 21 | Best Dice: 0.4120 at epoch 11
2025-07-23 05:38:53 INFO Test Loss: 7.9656 | Dice: 0.3909 | clDice: 0.4269 | IoU: 0.2433 | Tversky: 0.3909 | Hausdorff: 359.4926 | HD95: 130.1177
