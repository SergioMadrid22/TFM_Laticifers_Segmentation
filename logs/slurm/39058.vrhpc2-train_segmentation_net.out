2025-07-23 04:15:54 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_041554_unet_timm-resnest50d_clahe_sato', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_timm-resnest50d_clahe_sato', 'timestamp': '20250723_041554'}, 'test': {'batch_size': 1}, 'loss': {'name': 'hausdorff', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 04:15:54 INFO Experiment name: unet_timm-resnest50d_clahe_sato
2025-07-23 04:15:54 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 04:15:54 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 04:15:54 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 04:15:54 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 04:15:55 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 04:18:35 INFO Epoch 001 | Train Loss: 17.3499 | Val Loss: 9.5268 | Dice: 0.0818 | clDice: 0.0825 | IoU: 0.0428 | Tversky: 0.0818 | Hausdorff: 839.1072 | HD95: 412.2656 | LR: 0.001000
2025-07-23 04:21:12 INFO Epoch 002 | Train Loss: 13.3332 | Val Loss: 8.8762 | Dice: 0.3049 | clDice: 0.3255 | IoU: 0.1800 | Tversky: 0.3049 | Hausdorff: 511.6920 | HD95: 210.6198 | LR: 0.001000
2025-07-23 04:23:48 INFO Epoch 003 | Train Loss: 13.1733 | Val Loss: 8.9240 | Dice: 0.3938 | clDice: 0.4311 | IoU: 0.2456 | Tversky: 0.3938 | Hausdorff: 399.7520 | HD95: 120.2316 | LR: 0.001000
2025-07-23 04:26:27 INFO Epoch 004 | Train Loss: 13.1968 | Val Loss: 8.6435 | Dice: 0.4270 | clDice: 0.4688 | IoU: 0.2720 | Tversky: 0.4270 | Hausdorff: 303.0823 | HD95: 92.4880 | LR: 0.001000
2025-07-23 04:29:02 INFO Epoch 005 | Train Loss: 13.1923 | Val Loss: 8.6239 | Dice: 0.3528 | clDice: 0.3777 | IoU: 0.2144 | Tversky: 0.3528 | Hausdorff: 386.1894 | HD95: 134.4272 | LR: 0.001000
2025-07-23 04:31:40 INFO Epoch 006 | Train Loss: 13.0641 | Val Loss: 8.6085 | Dice: 0.3451 | clDice: 0.3698 | IoU: 0.2086 | Tversky: 0.3451 | Hausdorff: 322.8072 | HD95: 135.1468 | LR: 0.001000
2025-07-23 04:34:20 INFO Epoch 007 | Train Loss: 13.0843 | Val Loss: 8.7312 | Dice: 0.4120 | clDice: 0.4481 | IoU: 0.2600 | Tversky: 0.4120 | Hausdorff: 345.9418 | HD95: 102.7601 | LR: 0.001000
2025-07-23 04:37:04 INFO Epoch 008 | Train Loss: 13.0567 | Val Loss: 8.6179 | Dice: 0.3758 | clDice: 0.4057 | IoU: 0.2314 | Tversky: 0.3758 | Hausdorff: 345.2358 | HD95: 123.9955 | LR: 0.001000
2025-07-23 04:39:45 INFO Epoch 009 | Train Loss: 13.0319 | Val Loss: 8.5836 | Dice: 0.3565 | clDice: 0.3817 | IoU: 0.2172 | Tversky: 0.3565 | Hausdorff: 427.5294 | HD95: 159.5202 | LR: 0.001000
2025-07-23 04:42:20 INFO Epoch 010 | Train Loss: 12.9847 | Val Loss: 8.5815 | Dice: 0.4137 | clDice: 0.4468 | IoU: 0.2611 | Tversky: 0.4137 | Hausdorff: 313.2372 | HD95: 101.7903 | LR: 0.001000
2025-07-23 04:45:01 INFO Epoch 011 | Train Loss: 13.0264 | Val Loss: 8.5574 | Dice: 0.4043 | clDice: 0.4363 | IoU: 0.2538 | Tversky: 0.4043 | Hausdorff: 421.9898 | HD95: 113.5973 | LR: 0.001000
2025-07-23 04:47:38 INFO Epoch 012 | Train Loss: 13.0909 | Val Loss: 8.5740 | Dice: 0.3513 | clDice: 0.3749 | IoU: 0.2135 | Tversky: 0.3513 | Hausdorff: 489.1666 | HD95: 179.7352 | LR: 0.001000
2025-07-23 04:50:17 INFO Epoch 013 | Train Loss: 12.9797 | Val Loss: 8.5419 | Dice: 0.4284 | clDice: 0.4679 | IoU: 0.2731 | Tversky: 0.4284 | Hausdorff: 380.3538 | HD95: 108.1506 | LR: 0.001000
2025-07-23 04:52:54 INFO Epoch 014 | Train Loss: 13.0162 | Val Loss: 8.5479 | Dice: 0.4276 | clDice: 0.4639 | IoU: 0.2722 | Tversky: 0.4276 | Hausdorff: 327.8823 | HD95: 93.6071 | LR: 0.001000
2025-07-23 04:55:41 INFO Epoch 015 | Train Loss: 12.9567 | Val Loss: 8.5499 | Dice: 0.4021 | clDice: 0.4335 | IoU: 0.2519 | Tversky: 0.4021 | Hausdorff: 312.8836 | HD95: 111.7820 | LR: 0.001000
2025-07-23 04:58:22 INFO Epoch 016 | Train Loss: 13.1084 | Val Loss: 8.7162 | Dice: 0.2951 | clDice: 0.3197 | IoU: 0.1754 | Tversky: 0.2951 | Hausdorff: 498.8877 | HD95: 189.7188 | LR: 0.001000
2025-07-23 05:01:01 INFO Epoch 017 | Train Loss: 13.0324 | Val Loss: 8.5646 | Dice: 0.3784 | clDice: 0.4052 | IoU: 0.2342 | Tversky: 0.3784 | Hausdorff: 305.7415 | HD95: 113.0655 | LR: 0.001000
2025-07-23 05:03:42 INFO Epoch 018 | Train Loss: 12.8500 | Val Loss: 8.5738 | Dice: 0.3692 | clDice: 0.3911 | IoU: 0.2265 | Tversky: 0.3692 | Hausdorff: 352.0146 | HD95: 137.5926 | LR: 0.001000
2025-07-23 05:06:24 INFO Epoch 019 | Train Loss: 12.8544 | Val Loss: 8.5397 | Dice: 0.4199 | clDice: 0.4571 | IoU: 0.2664 | Tversky: 0.4199 | Hausdorff: 338.4769 | HD95: 107.6026 | LR: 0.001000
2025-07-23 05:09:03 INFO Epoch 020 | Train Loss: 13.0982 | Val Loss: 8.5411 | Dice: 0.3985 | clDice: 0.4299 | IoU: 0.2491 | Tversky: 0.3985 | Hausdorff: 335.2610 | HD95: 114.2866 | LR: 0.001000
2025-07-23 05:11:38 INFO Epoch 021 | Train Loss: 12.8996 | Val Loss: 8.5956 | Dice: 0.4304 | clDice: 0.4677 | IoU: 0.2749 | Tversky: 0.4304 | Hausdorff: 368.8914 | HD95: 87.2678 | LR: 0.001000
2025-07-23 05:14:08 INFO Epoch 022 | Train Loss: 13.0189 | Val Loss: 8.7285 | Dice: 0.3510 | clDice: 0.3793 | IoU: 0.2129 | Tversky: 0.3510 | Hausdorff: 475.2241 | HD95: 166.8437 | LR: 0.001000
2025-07-23 05:16:51 INFO Epoch 023 | Train Loss: 12.9857 | Val Loss: 8.5605 | Dice: 0.3686 | clDice: 0.3938 | IoU: 0.2267 | Tversky: 0.3686 | Hausdorff: 474.8582 | HD95: 144.0750 | LR: 0.001000
2025-07-23 05:19:32 INFO Epoch 024 | Train Loss: 12.7852 | Val Loss: 8.6097 | Dice: 0.3021 | clDice: 0.3219 | IoU: 0.1785 | Tversky: 0.3021 | Hausdorff: 405.0251 | HD95: 166.2817 | LR: 0.001000
2025-07-23 05:22:11 INFO Epoch 025 | Train Loss: 13.1020 | Val Loss: 8.5596 | Dice: 0.3863 | clDice: 0.4177 | IoU: 0.2397 | Tversky: 0.3863 | Hausdorff: 336.0692 | HD95: 117.6047 | LR: 0.001000
2025-07-23 05:24:47 INFO Epoch 026 | Train Loss: 12.8463 | Val Loss: 8.5290 | Dice: 0.4216 | clDice: 0.4554 | IoU: 0.2679 | Tversky: 0.4216 | Hausdorff: 325.0438 | HD95: 96.0440 | LR: 0.001000
2025-07-23 05:27:28 INFO Epoch 027 | Train Loss: 13.0005 | Val Loss: 8.5857 | Dice: 0.3402 | clDice: 0.3650 | IoU: 0.2055 | Tversky: 0.3402 | Hausdorff: 437.6602 | HD95: 159.4238 | LR: 0.001000
2025-07-23 05:30:13 INFO Epoch 028 | Train Loss: 13.0803 | Val Loss: 8.5484 | Dice: 0.4007 | clDice: 0.4317 | IoU: 0.2515 | Tversky: 0.4007 | Hausdorff: 403.8258 | HD95: 119.0963 | LR: 0.001000
2025-07-23 05:32:50 INFO Epoch 029 | Train Loss: 13.1066 | Val Loss: 8.5482 | Dice: 0.3926 | clDice: 0.4204 | IoU: 0.2447 | Tversky: 0.3926 | Hausdorff: 367.4129 | HD95: 103.4221 | LR: 0.001000
2025-07-23 05:35:23 INFO Epoch 030 | Train Loss: 13.0249 | Val Loss: 8.5506 | Dice: 0.3825 | clDice: 0.4089 | IoU: 0.2372 | Tversky: 0.3825 | Hausdorff: 507.8314 | HD95: 156.3529 | LR: 0.001000
2025-07-23 05:37:55 INFO Epoch 031 | Train Loss: 12.7044 | Val Loss: 8.1102 | Dice: 0.2475 | clDice: 0.2592 | IoU: 0.1449 | Tversky: 0.2475 | Hausdorff: 743.0520 | HD95: 298.8767 | LR: 0.001000
2025-07-23 05:40:27 INFO Epoch 032 | Train Loss: 12.8512 | Val Loss: 8.5322 | Dice: 0.4086 | clDice: 0.4434 | IoU: 0.2577 | Tversky: 0.4086 | Hausdorff: 407.7590 | HD95: 131.3933 | LR: 0.001000
2025-07-23 05:43:01 INFO Epoch 033 | Train Loss: 12.9719 | Val Loss: 8.5366 | Dice: 0.4041 | clDice: 0.4352 | IoU: 0.2534 | Tversky: 0.4041 | Hausdorff: 470.3392 | HD95: 140.2841 | LR: 0.001000
2025-07-23 05:45:38 INFO Epoch 034 | Train Loss: 12.9294 | Val Loss: 8.5470 | Dice: 0.3832 | clDice: 0.4118 | IoU: 0.2374 | Tversky: 0.3832 | Hausdorff: 378.6499 | HD95: 136.8488 | LR: 0.001000
2025-07-23 05:48:19 INFO Epoch 035 | Train Loss: 13.1794 | Val Loss: 8.5226 | Dice: 0.4310 | clDice: 0.4677 | IoU: 0.2749 | Tversky: 0.4310 | Hausdorff: 289.3295 | HD95: 90.4891 | LR: 0.001000
2025-07-23 05:50:47 INFO Epoch 036 | Train Loss: 12.8182 | Val Loss: 8.5453 | Dice: 0.4274 | clDice: 0.4620 | IoU: 0.2724 | Tversky: 0.4274 | Hausdorff: 279.8678 | HD95: 82.9698 | LR: 0.001000
2025-07-23 05:53:25 INFO Epoch 037 | Train Loss: 12.9056 | Val Loss: 8.5384 | Dice: 0.4447 | clDice: 0.4811 | IoU: 0.2865 | Tversky: 0.4447 | Hausdorff: 280.4035 | HD95: 69.8438 | LR: 0.001000
2025-07-23 05:56:02 INFO Epoch 038 | Train Loss: 12.9312 | Val Loss: 8.5238 | Dice: 0.4231 | clDice: 0.4569 | IoU: 0.2685 | Tversky: 0.4231 | Hausdorff: 300.9072 | HD95: 100.5922 | LR: 0.001000
2025-07-23 05:58:36 INFO Epoch 039 | Train Loss: 13.0047 | Val Loss: 8.5197 | Dice: 0.4292 | clDice: 0.4654 | IoU: 0.2737 | Tversky: 0.4292 | Hausdorff: 327.2640 | HD95: 101.9605 | LR: 0.001000
2025-07-23 06:01:08 INFO Epoch 040 | Train Loss: 12.8096 | Val Loss: 8.5255 | Dice: 0.4330 | clDice: 0.4658 | IoU: 0.2768 | Tversky: 0.4330 | Hausdorff: 298.6242 | HD95: 83.9300 | LR: 0.001000
2025-07-23 06:03:45 INFO Early stopping at epoch 41 | Best Dice: 0.4447 at epoch 31
2025-07-23 06:04:26 INFO Test Loss: 8.1102 | Dice: 0.2475 | clDice: 0.2592 | IoU: 0.1449 | Tversky: 0.2475 | Hausdorff: 743.0520 | HD95: 298.8767
