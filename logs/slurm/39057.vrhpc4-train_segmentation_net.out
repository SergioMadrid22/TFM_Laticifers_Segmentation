2025-07-23 03:10:55 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_031055_unet_timm-resnest50d_hausdorff_bce', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_timm-resnest50d_hausdorff_bce', 'timestamp': '20250723_031055'}, 'test': {'batch_size': 1}, 'loss': {'name': 'hausdorff', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 03:10:55 INFO Experiment name: unet_timm-resnest50d_hausdorff_bce
2025-07-23 03:10:55 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 03:10:55 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 03:10:55 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 03:10:55 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 03:10:55 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 03:13:18 INFO Epoch 001 | Train Loss: 17.3034 | Val Loss: 9.3253 | Dice: 0.3180 | clDice: 0.3476 | IoU: 0.1892 | Tversky: 0.3180 | Hausdorff: 541.7445 | HD95: 221.1099 | LR: 0.001000
2025-07-23 03:15:38 INFO Epoch 002 | Train Loss: 13.1898 | Val Loss: 8.8072 | Dice: 0.3973 | clDice: 0.4346 | IoU: 0.2487 | Tversky: 0.3973 | Hausdorff: 414.8929 | HD95: 95.4190 | LR: 0.001000
2025-07-23 03:17:58 INFO Epoch 003 | Train Loss: 13.1779 | Val Loss: 8.7040 | Dice: 0.3611 | clDice: 0.3918 | IoU: 0.2207 | Tversky: 0.3611 | Hausdorff: 461.0353 | HD95: 127.6321 | LR: 0.001000
2025-07-23 03:20:14 INFO Epoch 004 | Train Loss: 13.1512 | Val Loss: 8.7130 | Dice: 0.2392 | clDice: 0.2505 | IoU: 0.1361 | Tversky: 0.2392 | Hausdorff: 555.9130 | HD95: 259.3482 | LR: 0.001000
2025-07-23 03:22:33 INFO Epoch 005 | Train Loss: 13.1162 | Val Loss: 8.5956 | Dice: 0.3918 | clDice: 0.4213 | IoU: 0.2442 | Tversky: 0.3918 | Hausdorff: 306.1108 | HD95: 115.6242 | LR: 0.001000
2025-07-23 03:24:53 INFO Epoch 006 | Train Loss: 13.0200 | Val Loss: 8.5834 | Dice: 0.3931 | clDice: 0.4248 | IoU: 0.2451 | Tversky: 0.3931 | Hausdorff: 405.6803 | HD95: 120.8627 | LR: 0.001000
2025-07-23 03:27:12 INFO Epoch 007 | Train Loss: 13.0149 | Val Loss: 8.7495 | Dice: 0.3714 | clDice: 0.3994 | IoU: 0.2299 | Tversky: 0.3714 | Hausdorff: 395.1779 | HD95: 127.6917 | LR: 0.001000
2025-07-23 03:29:32 INFO Epoch 008 | Train Loss: 13.0052 | Val Loss: 9.6929 | Dice: 0.3904 | clDice: 0.4244 | IoU: 0.2430 | Tversky: 0.3904 | Hausdorff: 653.3240 | HD95: 104.9111 | LR: 0.001000
2025-07-23 03:31:46 INFO Epoch 009 | Train Loss: 13.0627 | Val Loss: 8.6469 | Dice: 0.3538 | clDice: 0.3833 | IoU: 0.2152 | Tversky: 0.3538 | Hausdorff: 356.8856 | HD95: 135.1911 | LR: 0.001000
2025-07-23 03:34:06 INFO Epoch 010 | Train Loss: 12.9145 | Val Loss: 8.5605 | Dice: 0.3872 | clDice: 0.4215 | IoU: 0.2406 | Tversky: 0.3872 | Hausdorff: 415.0034 | HD95: 139.2893 | LR: 0.001000
2025-07-23 03:36:27 INFO Epoch 011 | Train Loss: 12.9760 | Val Loss: 8.5468 | Dice: 0.4202 | clDice: 0.4558 | IoU: 0.2666 | Tversky: 0.4202 | Hausdorff: 415.7476 | HD95: 110.3501 | LR: 0.001000
2025-07-23 03:38:50 INFO Epoch 012 | Train Loss: 13.1153 | Val Loss: 8.5433 | Dice: 0.4144 | clDice: 0.4443 | IoU: 0.2621 | Tversky: 0.4144 | Hausdorff: 364.8811 | HD95: 100.4931 | LR: 0.001000
2025-07-23 03:41:03 INFO Epoch 013 | Train Loss: 12.9782 | Val Loss: 8.5648 | Dice: 0.4046 | clDice: 0.4363 | IoU: 0.2547 | Tversky: 0.4046 | Hausdorff: 330.4394 | HD95: 116.3833 | LR: 0.001000
2025-07-23 03:43:19 INFO Epoch 014 | Train Loss: 13.0257 | Val Loss: 8.5663 | Dice: 0.3587 | clDice: 0.3801 | IoU: 0.2187 | Tversky: 0.3587 | Hausdorff: 409.7899 | HD95: 147.1622 | LR: 0.001000
2025-07-23 03:45:41 INFO Epoch 015 | Train Loss: 12.9853 | Val Loss: 8.5631 | Dice: 0.3801 | clDice: 0.4120 | IoU: 0.2349 | Tversky: 0.3801 | Hausdorff: 402.4224 | HD95: 130.9114 | LR: 0.001000
2025-07-23 03:48:04 INFO Epoch 016 | Train Loss: 13.1001 | Val Loss: 8.5243 | Dice: 0.4312 | clDice: 0.4635 | IoU: 0.2752 | Tversky: 0.4312 | Hausdorff: 291.2245 | HD95: 87.9630 | LR: 0.001000
2025-07-23 03:50:18 INFO Epoch 017 | Train Loss: 13.0018 | Val Loss: 8.5395 | Dice: 0.3920 | clDice: 0.4201 | IoU: 0.2443 | Tversky: 0.3920 | Hausdorff: 410.5102 | HD95: 120.9295 | LR: 0.001000
2025-07-23 03:52:36 INFO Epoch 018 | Train Loss: 12.8996 | Val Loss: 8.5604 | Dice: 0.3667 | clDice: 0.3916 | IoU: 0.2247 | Tversky: 0.3667 | Hausdorff: 453.9205 | HD95: 149.4145 | LR: 0.001000
2025-07-23 03:54:57 INFO Epoch 019 | Train Loss: 12.8079 | Val Loss: 8.5548 | Dice: 0.3705 | clDice: 0.3979 | IoU: 0.2274 | Tversky: 0.3705 | Hausdorff: 446.7265 | HD95: 164.1876 | LR: 0.001000
2025-07-23 03:57:17 INFO Epoch 020 | Train Loss: 13.1100 | Val Loss: 8.5425 | Dice: 0.4379 | clDice: 0.4763 | IoU: 0.2811 | Tversky: 0.4379 | Hausdorff: 299.0324 | HD95: 79.1474 | LR: 0.001000
2025-07-23 03:59:35 INFO Epoch 021 | Train Loss: 12.8777 | Val Loss: 8.5495 | Dice: 0.3859 | clDice: 0.4164 | IoU: 0.2395 | Tversky: 0.3859 | Hausdorff: 458.3098 | HD95: 158.9683 | LR: 0.001000
2025-07-23 04:01:49 INFO Epoch 022 | Train Loss: 13.0080 | Val Loss: 8.5301 | Dice: 0.4481 | clDice: 0.4872 | IoU: 0.2891 | Tversky: 0.4481 | Hausdorff: 291.9347 | HD95: 85.7847 | LR: 0.001000
2025-07-23 04:04:09 INFO Epoch 023 | Train Loss: 13.0520 | Val Loss: 8.5433 | Dice: 0.3851 | clDice: 0.4117 | IoU: 0.2389 | Tversky: 0.3851 | Hausdorff: 315.5812 | HD95: 112.2843 | LR: 0.001000
2025-07-23 04:06:32 INFO Epoch 024 | Train Loss: 12.8305 | Val Loss: 8.5947 | Dice: 0.3182 | clDice: 0.3368 | IoU: 0.1897 | Tversky: 0.3182 | Hausdorff: 526.5073 | HD95: 189.0932 | LR: 0.001000
2025-07-23 04:08:56 INFO Epoch 025 | Train Loss: 13.1502 | Val Loss: 8.4674 | Dice: 0.3723 | clDice: 0.4111 | IoU: 0.2290 | Tversky: 0.3723 | Hausdorff: 808.7568 | HD95: 190.2934 | LR: 0.001000
2025-07-23 04:11:06 INFO Epoch 026 | Train Loss: 12.8817 | Val Loss: 8.5747 | Dice: 0.3586 | clDice: 0.3859 | IoU: 0.2199 | Tversky: 0.3586 | Hausdorff: 533.9819 | HD95: 171.0735 | LR: 0.001000
2025-07-23 04:13:17 INFO Epoch 027 | Train Loss: 12.9979 | Val Loss: 8.5475 | Dice: 0.3931 | clDice: 0.4198 | IoU: 0.2452 | Tversky: 0.3931 | Hausdorff: 413.6453 | HD95: 117.1689 | LR: 0.001000
2025-07-23 04:15:36 INFO Epoch 028 | Train Loss: 13.0023 | Val Loss: 8.6606 | Dice: 0.2745 | clDice: 0.2903 | IoU: 0.1593 | Tversky: 0.2745 | Hausdorff: 436.0729 | HD95: 178.0465 | LR: 0.001000
2025-07-23 04:17:59 INFO Epoch 029 | Train Loss: 13.0183 | Val Loss: 8.5547 | Dice: 0.3714 | clDice: 0.3977 | IoU: 0.2288 | Tversky: 0.3714 | Hausdorff: 483.3305 | HD95: 166.9249 | LR: 0.001000
2025-07-23 04:20:23 INFO Epoch 030 | Train Loss: 13.0292 | Val Loss: 8.5508 | Dice: 0.3917 | clDice: 0.4179 | IoU: 0.2439 | Tversky: 0.3917 | Hausdorff: 317.0495 | HD95: 119.1077 | LR: 0.001000
2025-07-23 04:22:37 INFO Epoch 031 | Train Loss: 12.8434 | Val Loss: 8.6656 | Dice: 0.4047 | clDice: 0.4319 | IoU: 0.2544 | Tversky: 0.4047 | Hausdorff: 394.0787 | HD95: 105.5026 | LR: 0.001000
2025-07-23 04:24:53 INFO Epoch 032 | Train Loss: 11.4213 | Val Loss: 7.8534 | Dice: 0.2940 | clDice: 0.3059 | IoU: 0.1725 | Tversky: 0.2940 | Hausdorff: 549.1673 | HD95: 203.7475 | LR: 0.001000
2025-07-23 04:27:18 INFO Epoch 033 | Train Loss: 12.4028 | Val Loss: 8.0359 | Dice: 0.3665 | clDice: 0.3925 | IoU: 0.2249 | Tversky: 0.3665 | Hausdorff: 480.5118 | HD95: 151.8229 | LR: 0.001000
2025-07-23 04:29:43 INFO Epoch 034 | Train Loss: 12.9605 | Val Loss: 8.5685 | Dice: 0.3696 | clDice: 0.3928 | IoU: 0.2272 | Tversky: 0.3696 | Hausdorff: 666.9932 | HD95: 152.8007 | LR: 0.001000
2025-07-23 04:31:57 INFO Epoch 035 | Train Loss: 13.1063 | Val Loss: 8.6503 | Dice: 0.2425 | clDice: 0.2524 | IoU: 0.1394 | Tversky: 0.2425 | Hausdorff: 593.4231 | HD95: 297.3932 | LR: 0.001000
2025-07-23 04:34:10 INFO Epoch 036 | Train Loss: 12.9353 | Val Loss: 8.5364 | Dice: 0.4286 | clDice: 0.4644 | IoU: 0.2733 | Tversky: 0.4286 | Hausdorff: 375.0878 | HD95: 90.1753 | LR: 0.001000
2025-07-23 04:36:27 INFO Epoch 037 | Train Loss: 12.9683 | Val Loss: 8.5393 | Dice: 0.3996 | clDice: 0.4260 | IoU: 0.2501 | Tversky: 0.3996 | Hausdorff: 398.0098 | HD95: 123.8196 | LR: 0.001000
2025-07-23 04:38:54 INFO Epoch 038 | Train Loss: 12.9158 | Val Loss: 8.5490 | Dice: 0.4314 | clDice: 0.4630 | IoU: 0.2759 | Tversky: 0.4314 | Hausdorff: 292.6035 | HD95: 78.0275 | LR: 0.001000
2025-07-23 04:41:20 INFO Epoch 039 | Train Loss: 13.0569 | Val Loss: 8.5286 | Dice: 0.4204 | clDice: 0.4508 | IoU: 0.2668 | Tversky: 0.4204 | Hausdorff: 395.1311 | HD95: 116.4679 | LR: 0.001000
2025-07-23 04:43:34 INFO Epoch 040 | Train Loss: 12.7056 | Val Loss: 8.5533 | Dice: 0.3873 | clDice: 0.4170 | IoU: 0.2417 | Tversky: 0.3873 | Hausdorff: 392.7505 | HD95: 123.7678 | LR: 0.001000
2025-07-23 04:45:53 INFO Epoch 041 | Train Loss: 12.8272 | Val Loss: 8.5645 | Dice: 0.4297 | clDice: 0.4600 | IoU: 0.2741 | Tversky: 0.4297 | Hausdorff: 374.4756 | HD95: 84.0320 | LR: 0.001000
2025-07-23 04:48:14 INFO Early stopping at epoch 42 | Best Dice: 0.4481 at epoch 32
2025-07-23 04:49:00 INFO Test Loss: 7.8534 | Dice: 0.2940 | clDice: 0.3059 | IoU: 0.1725 | Tversky: 0.2940 | Hausdorff: 549.1673 | HD95: 203.7475
