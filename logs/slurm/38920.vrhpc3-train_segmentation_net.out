/data/smadper@alumno.upv.es/TFM/env/lib/python3.8/site-packages/albumentations/__init__.py:13: UserWarning: A new version of Albumentations is available: 2.0.8 (you have 1.4.18). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.
  check_for_updates()
2025-07-20 20:42:35 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_densenet121', 'encoder_name': 'densenet121', 'encoder_weights': 'imagenet', 'in_channels': 2, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'image_size': [512, 512], 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'sato': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/sato_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 50, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints', 'log_interval': 1, 'patience': 10, 'experiment_name': 'unet_sato_densenet121', 'timestamp': '20250720_204235'}, 'test': {'batch_size': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/results'}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 0.5, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-20 20:42:35 INFO Experiment name: unet_sato_densenet121
2025-07-20 20:42:35 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_densenet121', 'encoder_name': 'densenet121', 'encoder_weights': 'imagenet', 'in_channels': 2, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}
/data/smadper@alumno.upv.es/TFM/src/datasets.py:240: UserWarning: Argument 'alpha_affine' is not valid and will be ignored.
  A.ElasticTransform(alpha=120, sigma=120 * 0.05, alpha_affine=120 * 0.03, p=0.3),
2025-07-20 20:43:51 INFO Epoch 001 | Train Loss: 0.5428 | Val Loss: 0.4155 | Dice: 0.3930 | clDice: 0.4392 |IoU: 0.2446 | LR: 0.001000
2025-07-20 20:45:10 INFO Epoch 002 | Train Loss: 0.4868 | Val Loss: 0.3925 | Dice: 0.4161 | clDice: 0.4615 |IoU: 0.2629 | LR: 0.001000
2025-07-20 20:46:34 INFO Epoch 003 | Train Loss: 0.4746 | Val Loss: 0.3860 | Dice: 0.4393 | clDice: 0.4742 |IoU: 0.2816 | LR: 0.001000
2025-07-20 20:47:59 INFO Epoch 004 | Train Loss: 0.4718 | Val Loss: 0.3754 | Dice: 0.4449 | clDice: 0.4742 |IoU: 0.2862 | LR: 0.001000
2025-07-20 20:49:15 INFO Epoch 005 | Train Loss: 0.4693 | Val Loss: 0.3598 | Dice: 0.4607 | clDice: 0.4882 |IoU: 0.2996 | LR: 0.001000
2025-07-20 20:50:32 INFO Epoch 006 | Train Loss: 0.4594 | Val Loss: 0.3714 | Dice: 0.4666 | clDice: 0.5245 |IoU: 0.3043 | LR: 0.001000
2025-07-20 20:51:46 INFO Epoch 007 | Train Loss: 0.4615 | Val Loss: 0.3634 | Dice: 0.4669 | clDice: 0.4900 |IoU: 0.3048 | LR: 0.001000
2025-07-20 20:53:01 INFO Epoch 008 | Train Loss: 0.4550 | Val Loss: 0.4105 | Dice: 0.3891 | clDice: 0.3975 |IoU: 0.2417 | LR: 0.001000
2025-07-20 20:54:20 INFO Epoch 009 | Train Loss: 0.4542 | Val Loss: 0.3613 | Dice: 0.4734 | clDice: 0.5303 |IoU: 0.3102 | LR: 0.001000
2025-07-20 20:55:33 INFO Epoch 010 | Train Loss: 0.4516 | Val Loss: 0.3582 | Dice: 0.4778 | clDice: 0.5333 |IoU: 0.3141 | LR: 0.001000
2025-07-20 20:56:49 INFO Epoch 011 | Train Loss: 0.4489 | Val Loss: 0.3556 | Dice: 0.4724 | clDice: 0.5065 |IoU: 0.3094 | LR: 0.001000
2025-07-20 20:58:06 INFO Epoch 012 | Train Loss: 0.4543 | Val Loss: 0.3578 | Dice: 0.4786 | clDice: 0.5228 |IoU: 0.3148 | LR: 0.001000
2025-07-20 20:59:22 INFO Epoch 013 | Train Loss: 0.4465 | Val Loss: 0.3735 | Dice: 0.4782 | clDice: 0.5278 |IoU: 0.3144 | LR: 0.001000
2025-07-20 21:00:37 INFO Epoch 014 | Train Loss: 0.4437 | Val Loss: 0.3570 | Dice: 0.4648 | clDice: 0.4808 |IoU: 0.3032 | LR: 0.001000
2025-07-20 21:01:56 INFO Epoch 015 | Train Loss: 0.4479 | Val Loss: 0.3507 | Dice: 0.4719 | clDice: 0.4907 |IoU: 0.3090 | LR: 0.001000
2025-07-20 21:03:10 INFO Epoch 016 | Train Loss: 0.4444 | Val Loss: 0.3459 | Dice: 0.4847 | clDice: 0.5149 |IoU: 0.3202 | LR: 0.001000
2025-07-20 21:04:27 INFO Epoch 017 | Train Loss: 0.4461 | Val Loss: 0.3530 | Dice: 0.4804 | clDice: 0.5038 |IoU: 0.3164 | LR: 0.001000
2025-07-20 21:05:44 INFO Epoch 018 | Train Loss: 0.4509 | Val Loss: 0.3537 | Dice: 0.4883 | clDice: 0.5400 |IoU: 0.3232 | LR: 0.001000
2025-07-20 21:06:58 INFO Epoch 019 | Train Loss: 0.4416 | Val Loss: 0.3661 | Dice: 0.4632 | clDice: 0.4780 |IoU: 0.3018 | LR: 0.001000
2025-07-20 21:08:17 INFO Epoch 020 | Train Loss: 0.4374 | Val Loss: 0.3576 | Dice: 0.4819 | clDice: 0.5165 |IoU: 0.3178 | LR: 0.001000
2025-07-20 21:09:29 INFO Epoch 021 | Train Loss: 0.4466 | Val Loss: 0.3514 | Dice: 0.4837 | clDice: 0.5159 |IoU: 0.3194 | LR: 0.001000
2025-07-20 21:10:45 INFO Epoch 022 | Train Loss: 0.4397 | Val Loss: 0.3452 | Dice: 0.4891 | clDice: 0.5177 |IoU: 0.3241 | LR: 0.001000
2025-07-20 21:12:01 INFO Epoch 023 | Train Loss: 0.4405 | Val Loss: 0.3508 | Dice: 0.4829 | clDice: 0.5147 |IoU: 0.3187 | LR: 0.001000
2025-07-20 21:13:16 INFO Epoch 024 | Train Loss: 0.4421 | Val Loss: 0.3641 | Dice: 0.4758 | clDice: 0.5116 |IoU: 0.3123 | LR: 0.001000
2025-07-20 21:14:32 INFO Epoch 025 | Train Loss: 0.4405 | Val Loss: 0.3455 | Dice: 0.4821 | clDice: 0.5003 |IoU: 0.3180 | LR: 0.001000
2025-07-20 21:15:50 INFO Epoch 026 | Train Loss: 0.4398 | Val Loss: 0.3458 | Dice: 0.4915 | clDice: 0.5307 |IoU: 0.3261 | LR: 0.001000
2025-07-20 21:17:03 INFO Epoch 027 | Train Loss: 0.4398 | Val Loss: 0.3646 | Dice: 0.4788 | clDice: 0.5144 |IoU: 0.3149 | LR: 0.001000
2025-07-20 21:18:16 INFO Epoch 028 | Train Loss: 0.4342 | Val Loss: 0.3490 | Dice: 0.4706 | clDice: 0.4901 |IoU: 0.3083 | LR: 0.001000
2025-07-20 21:19:30 INFO Epoch 029 | Train Loss: 0.4397 | Val Loss: 0.3516 | Dice: 0.4855 | clDice: 0.5293 |IoU: 0.3208 | LR: 0.001000
2025-07-20 21:20:43 INFO Epoch 030 | Train Loss: 0.4377 | Val Loss: 0.3569 | Dice: 0.4820 | clDice: 0.5222 |IoU: 0.3178 | LR: 0.001000
2025-07-20 21:21:57 INFO Epoch 031 | Train Loss: 0.4406 | Val Loss: 0.3436 | Dice: 0.4889 | clDice: 0.5108 |IoU: 0.3239 | LR: 0.001000
2025-07-20 21:23:13 INFO Epoch 032 | Train Loss: 0.4420 | Val Loss: 0.3494 | Dice: 0.4907 | clDice: 0.5297 |IoU: 0.3254 | LR: 0.001000
2025-07-20 21:24:25 INFO Epoch 033 | Train Loss: 0.4407 | Val Loss: 0.3573 | Dice: 0.4789 | clDice: 0.5262 |IoU: 0.3150 | LR: 0.001000
2025-07-20 21:25:41 INFO Epoch 034 | Train Loss: 0.4363 | Val Loss: 0.3414 | Dice: 0.4832 | clDice: 0.4986 |IoU: 0.3190 | LR: 0.001000
2025-07-20 21:26:52 INFO Epoch 035 | Train Loss: 0.4324 | Val Loss: 0.3477 | Dice: 0.4760 | clDice: 0.4982 |IoU: 0.3130 | LR: 0.001000
2025-07-20 21:28:04 INFO Epoch 036 | Train Loss: 0.4382 | Val Loss: 0.3809 | Dice: 0.4574 | clDice: 0.5168 |IoU: 0.2976 | LR: 0.001000
2025-07-20 21:29:20 INFO Epoch 037 | Train Loss: 0.4378 | Val Loss: 0.3474 | Dice: 0.4756 | clDice: 0.4878 |IoU: 0.3124 | LR: 0.001000
2025-07-20 21:30:32 INFO Epoch 038 | Train Loss: 0.4357 | Val Loss: 0.3598 | Dice: 0.4892 | clDice: 0.5218 |IoU: 0.3243 | LR: 0.001000
2025-07-20 21:31:47 INFO Epoch 039 | Train Loss: 0.4351 | Val Loss: 0.3491 | Dice: 0.4859 | clDice: 0.5320 |IoU: 0.3211 | LR: 0.001000
2025-07-20 21:33:00 INFO Epoch 040 | Train Loss: 0.4358 | Val Loss: 0.3432 | Dice: 0.4849 | clDice: 0.5038 |IoU: 0.3204 | LR: 0.001000
2025-07-20 21:34:13 INFO Epoch 041 | Train Loss: 0.4289 | Val Loss: 0.3402 | Dice: 0.4911 | clDice: 0.5228 |IoU: 0.3257 | LR: 0.001000
2025-07-20 21:35:28 INFO Epoch 042 | Train Loss: 0.4338 | Val Loss: 0.3565 | Dice: 0.4883 | clDice: 0.5407 |IoU: 0.3234 | LR: 0.001000
2025-07-20 21:36:42 INFO Epoch 043 | Train Loss: 0.4328 | Val Loss: 0.3490 | Dice: 0.4857 | clDice: 0.5100 |IoU: 0.3211 | LR: 0.001000
2025-07-20 21:37:55 INFO Epoch 044 | Train Loss: 0.4302 | Val Loss: 0.3413 | Dice: 0.4911 | clDice: 0.5157 |IoU: 0.3257 | LR: 0.001000
2025-07-20 21:39:09 INFO Epoch 045 | Train Loss: 0.4325 | Val Loss: 0.3431 | Dice: 0.4924 | clDice: 0.5297 |IoU: 0.3269 | LR: 0.001000
2025-07-20 21:40:23 INFO Epoch 046 | Train Loss: 0.4327 | Val Loss: 0.3427 | Dice: 0.4956 | clDice: 0.5243 |IoU: 0.3297 | LR: 0.001000
2025-07-20 21:41:36 INFO Epoch 047 | Train Loss: 0.4272 | Val Loss: 0.3405 | Dice: 0.4930 | clDice: 0.5356 |IoU: 0.3274 | LR: 0.001000
2025-07-20 21:42:52 INFO Epoch 048 | Train Loss: 0.4290 | Val Loss: 0.3380 | Dice: 0.4969 | clDice: 0.5350 |IoU: 0.3309 | LR: 0.001000
2025-07-20 21:44:06 INFO Epoch 049 | Train Loss: 0.4311 | Val Loss: 0.3407 | Dice: 0.4949 | clDice: 0.5460 |IoU: 0.3290 | LR: 0.001000
2025-07-20 21:45:19 INFO Epoch 050 | Train Loss: 0.4308 | Val Loss: 0.3439 | Dice: 0.4865 | clDice: 0.5174 |IoU: 0.3217 | LR: 0.001000
2025-07-20 21:45:19 INFO Training completed.
2025-07-20 21:45:39 INFO Test Loss: 0.3380 | Dice: 0.4969 | IoU: 0.3309 | clDice: 0.5350
