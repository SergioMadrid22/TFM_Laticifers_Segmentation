2025-07-27 19:31:56 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_densenet121', 'encoder_name': 'densenet121', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 80, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints2/unet/20250727_193156_bce_dice_60patches', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'bce_dice_60patches', 'timestamp': '20250727_193156'}, 'test': {'batch_size': 1}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 0.5, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-27 19:31:56 INFO Experiment name: bce_dice_60patches
2025-07-27 19:31:56 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_densenet121', 'encoder_name': 'densenet121', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-27 19:34:49 INFO Epoch 001 | Train Loss: 0.4493 | Val Loss: 0.3674 | Dice: 0.4470 | clDice: 0.4889 | IoU: 0.2881 | Tversky: 0.4470 | Hausdorff: 514.7196 | HD95: 58.4042 | LR: 0.001000
2025-07-27 19:37:43 INFO Epoch 002 | Train Loss: 0.3902 | Val Loss: 0.3508 | Dice: 0.4772 | clDice: 0.5250 | IoU: 0.3139 | Tversky: 0.4772 | Hausdorff: 267.2559 | HD95: 42.4116 | LR: 0.001000
2025-07-27 19:40:34 INFO Epoch 003 | Train Loss: 0.3832 | Val Loss: 0.3452 | Dice: 0.4791 | clDice: 0.5355 | IoU: 0.3152 | Tversky: 0.4791 | Hausdorff: 246.6022 | HD95: 41.1840 | LR: 0.001000
2025-07-27 19:43:30 INFO Epoch 004 | Train Loss: 0.3800 | Val Loss: 0.3458 | Dice: 0.4749 | clDice: 0.5235 | IoU: 0.3120 | Tversky: 0.4749 | Hausdorff: 243.1956 | HD95: 48.6401 | LR: 0.001000
2025-07-27 19:46:26 INFO Epoch 005 | Train Loss: 0.3760 | Val Loss: 0.3435 | Dice: 0.4836 | clDice: 0.5288 | IoU: 0.3194 | Tversky: 0.4836 | Hausdorff: 243.6166 | HD95: 37.9916 | LR: 0.001000
2025-07-27 19:49:10 INFO Epoch 006 | Train Loss: 0.3756 | Val Loss: 0.3366 | Dice: 0.4933 | clDice: 0.5412 | IoU: 0.3279 | Tversky: 0.4933 | Hausdorff: 299.8162 | HD95: 35.5841 | LR: 0.001000
2025-07-27 19:52:03 INFO Epoch 007 | Train Loss: 0.3721 | Val Loss: 0.3425 | Dice: 0.4841 | clDice: 0.5349 | IoU: 0.3197 | Tversky: 0.4841 | Hausdorff: 243.2302 | HD95: 32.3478 | LR: 0.001000
2025-07-27 19:54:55 INFO Epoch 008 | Train Loss: 0.3718 | Val Loss: 0.3399 | Dice: 0.4866 | clDice: 0.5364 | IoU: 0.3219 | Tversky: 0.4866 | Hausdorff: 238.4901 | HD95: 30.6297 | LR: 0.001000
2025-07-27 19:57:45 INFO Epoch 009 | Train Loss: 0.3695 | Val Loss: 0.3453 | Dice: 0.4840 | clDice: 0.5309 | IoU: 0.3197 | Tversky: 0.4840 | Hausdorff: 491.4429 | HD95: 35.8244 | LR: 0.001000
2025-07-27 20:00:36 INFO Epoch 010 | Train Loss: 0.3686 | Val Loss: 0.3448 | Dice: 0.4764 | clDice: 0.5202 | IoU: 0.3130 | Tversky: 0.4764 | Hausdorff: 243.5264 | HD95: 37.4090 | LR: 0.001000
2025-07-27 20:03:31 INFO Epoch 011 | Train Loss: 0.3685 | Val Loss: 0.3359 | Dice: 0.4951 | clDice: 0.5450 | IoU: 0.3294 | Tversky: 0.4951 | Hausdorff: 247.0970 | HD95: 33.2365 | LR: 0.001000
2025-07-27 20:06:25 INFO Epoch 012 | Train Loss: 0.3648 | Val Loss: 0.3373 | Dice: 0.4882 | clDice: 0.5348 | IoU: 0.3234 | Tversky: 0.4882 | Hausdorff: 243.9452 | HD95: 35.6306 | LR: 0.001000
2025-07-27 20:09:19 INFO Epoch 013 | Train Loss: 0.3673 | Val Loss: 0.3400 | Dice: 0.4860 | clDice: 0.5329 | IoU: 0.3214 | Tversky: 0.4860 | Hausdorff: 285.1195 | HD95: 29.2393 | LR: 0.001000
2025-07-27 20:12:13 INFO Epoch 014 | Train Loss: 0.3661 | Val Loss: 0.3436 | Dice: 0.4899 | clDice: 0.5458 | IoU: 0.3248 | Tversky: 0.4899 | Hausdorff: 266.5856 | HD95: 31.3131 | LR: 0.001000
2025-07-27 20:15:06 INFO Epoch 015 | Train Loss: 0.3633 | Val Loss: 0.3399 | Dice: 0.4854 | clDice: 0.5281 | IoU: 0.3209 | Tversky: 0.4854 | Hausdorff: 246.8177 | HD95: 28.9594 | LR: 0.001000
2025-07-27 20:17:57 INFO Epoch 016 | Train Loss: 0.3632 | Val Loss: 0.3384 | Dice: 0.4891 | clDice: 0.5312 | IoU: 0.3241 | Tversky: 0.4891 | Hausdorff: 241.3187 | HD95: 27.4376 | LR: 0.001000
2025-07-27 20:20:52 INFO Epoch 017 | Train Loss: 0.3626 | Val Loss: 0.3412 | Dice: 0.4828 | clDice: 0.5276 | IoU: 0.3185 | Tversky: 0.4828 | Hausdorff: 239.1367 | HD95: 32.4638 | LR: 0.001000
2025-07-27 20:23:46 INFO Epoch 018 | Train Loss: 0.3620 | Val Loss: 0.3434 | Dice: 0.4840 | clDice: 0.5335 | IoU: 0.3197 | Tversky: 0.4840 | Hausdorff: 496.4776 | HD95: 28.3684 | LR: 0.001000
2025-07-27 20:26:30 INFO Epoch 019 | Train Loss: 0.3602 | Val Loss: 0.3374 | Dice: 0.4918 | clDice: 0.5403 | IoU: 0.3266 | Tversky: 0.4918 | Hausdorff: 240.8867 | HD95: 29.2720 | LR: 0.001000
2025-07-27 20:29:26 INFO Epoch 020 | Train Loss: 0.3592 | Val Loss: 0.3423 | Dice: 0.4840 | clDice: 0.5287 | IoU: 0.3196 | Tversky: 0.4840 | Hausdorff: 381.0725 | HD95: 30.4198 | LR: 0.001000
2025-07-27 20:32:16 INFO Early stopping at epoch 21 | Best Dice: 0.4951 at epoch 11
2025-07-27 20:32:47 INFO Test Loss: 0.3359 | Dice: 0.4951 | clDice: 0.5450 | IoU: 0.3294 | Tversky: 0.4951 | Hausdorff: 247.0970 | HD95: 33.2365
