2025-07-21 23:05:24 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_resnet18', 'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 10, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 100, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_resnet18_imagenet', 'timestamp': '20250721_230524'}, 'test': {'batch_size': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/results'}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': True, 'combine_with': 'dice', 'weights': {'main': 0.5, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-21 23:05:24 INFO Experiment name: unet_resnet18_imagenet
2025-07-21 23:05:24 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_resnet18', 'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
/data/smadper@alumno.upv.es/TFM/src/datasets.py:240: UserWarning: Argument(s) 'alpha_affine' are not valid for transform ElasticTransform
  A.ElasticTransform(alpha=120, sigma=120 * 0.05, alpha_affine=120 * 0.03, p=0.3),
/data/smadper@alumno.upv.es/TFM/src/datasets.py:243: UserWarning: Argument(s) 'var_limit' are not valid for transform GaussNoise
  A.GaussNoise(var_limit=(10.0, 50.0), p=0.2),
2025-07-21 23:06:00 INFO Epoch 001 | Train Loss: 0.9416 | Val Loss: 0.5337 | Dice: 0.0013 | clDice: 0.0013 |IoU: 0.0006 | LR: 0.001000
2025-07-21 23:06:34 INFO Epoch 002 | Train Loss: 0.4055 | Val Loss: 0.3250 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:07:07 INFO Epoch 003 | Train Loss: 0.3002 | Val Loss: 0.2325 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:07:43 INFO Epoch 004 | Train Loss: 0.2687 | Val Loss: 0.2001 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:08:18 INFO Epoch 005 | Train Loss: 0.2587 | Val Loss: 0.1868 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:08:52 INFO Epoch 006 | Train Loss: 0.2514 | Val Loss: 0.1717 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:09:27 INFO Epoch 007 | Train Loss: 0.2490 | Val Loss: 0.1739 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:10:04 INFO Epoch 008 | Train Loss: 0.2471 | Val Loss: 0.1614 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:10:38 INFO Epoch 009 | Train Loss: 0.2467 | Val Loss: 0.1782 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:11:12 INFO Epoch 010 | Train Loss: 0.2373 | Val Loss: 0.2896 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:11:45 INFO Epoch 011 | Train Loss: 0.2419 | Val Loss: 0.1647 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:12:21 INFO Epoch 012 | Train Loss: 0.2253 | Val Loss: 0.1448 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
2025-07-21 23:12:55 INFO Epoch 013 | Train Loss: 0.2276 | Val Loss: 0.1324 | Dice: 0.0000 | clDice: 0.0000 |IoU: 0.0000 | LR: 0.001000
slurmstepd: error: *** JOB 38977 ON vrhpc4.dsic.upv.es CANCELLED AT 2025-07-21T23:12:56 ***
