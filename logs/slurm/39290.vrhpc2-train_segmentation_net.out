2025-07-27 22:03:14 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_densenet121', 'encoder_name': 'densenet121', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints2/unet/20250727_220314_bce_dice_curr_learn', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'curriculum_schedule': [[0, 3], [5, 2], [10, 1], [15, 0]], 'experiment_name': 'bce_dice_curr_learn', 'timestamp': '20250727_220314'}, 'test': {'batch_size': 1}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 0.5, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-27 22:03:14 INFO Experiment name: bce_dice_curr_learn
2025-07-27 22:03:14 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_densenet121', 'encoder_name': 'densenet121', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-27 22:03:15 INFO Epoch 1: Curriculum level set to 3
2025-07-27 22:05:01 INFO Epoch 001 | Train Loss: 0.4473 | Val Loss: 0.3982 | Dice: 0.4113 | clDice: 0.4574 | IoU: 0.2589 | Tversky: 0.4113 | Hausdorff: 529.7744 | HD95: 94.7478 | LR: 0.001000
2025-07-27 22:05:01 INFO Epoch 2: Curriculum level set to 3
2025-07-27 22:06:46 INFO Epoch 002 | Train Loss: 0.3468 | Val Loss: 0.3755 | Dice: 0.4576 | clDice: 0.5272 | IoU: 0.2969 | Tversky: 0.4576 | Hausdorff: 277.2733 | HD95: 43.4687 | LR: 0.001000
2025-07-27 22:06:46 INFO Epoch 3: Curriculum level set to 3
2025-07-27 22:08:33 INFO Epoch 003 | Train Loss: 0.3292 | Val Loss: 0.3721 | Dice: 0.4572 | clDice: 0.5390 | IoU: 0.2965 | Tversky: 0.4572 | Hausdorff: 260.8447 | HD95: 56.9190 | LR: 0.001000
2025-07-27 22:08:33 INFO Epoch 4: Curriculum level set to 3
2025-07-27 22:10:21 INFO Epoch 004 | Train Loss: 0.3232 | Val Loss: 0.3789 | Dice: 0.4516 | clDice: 0.5322 | IoU: 0.2917 | Tversky: 0.4516 | Hausdorff: 240.8142 | HD95: 55.8803 | LR: 0.001000
2025-07-27 22:10:21 INFO Epoch 5: Curriculum level set to 2
2025-07-27 22:12:07 INFO Epoch 005 | Train Loss: 0.3395 | Val Loss: 0.3646 | Dice: 0.4604 | clDice: 0.5250 | IoU: 0.2994 | Tversky: 0.4604 | Hausdorff: 260.2302 | HD95: 53.7741 | LR: 0.001000
2025-07-27 22:12:07 INFO Epoch 6: Curriculum level set to 2
2025-07-27 22:13:54 INFO Epoch 006 | Train Loss: 0.3329 | Val Loss: 0.3684 | Dice: 0.4703 | clDice: 0.5581 | IoU: 0.3077 | Tversky: 0.4703 | Hausdorff: 247.4315 | HD95: 39.3638 | LR: 0.001000
2025-07-27 22:13:54 INFO Epoch 7: Curriculum level set to 2
2025-07-27 22:15:40 INFO Epoch 007 | Train Loss: 0.3300 | Val Loss: 0.3506 | Dice: 0.4834 | clDice: 0.5585 | IoU: 0.3190 | Tversky: 0.4834 | Hausdorff: 243.2110 | HD95: 31.8250 | LR: 0.001000
2025-07-27 22:15:40 INFO Epoch 8: Curriculum level set to 2
2025-07-27 22:17:27 INFO Epoch 008 | Train Loss: 0.3303 | Val Loss: 0.3492 | Dice: 0.4864 | clDice: 0.5636 | IoU: 0.3215 | Tversky: 0.4864 | Hausdorff: 240.3310 | HD95: 33.1025 | LR: 0.001000
2025-07-27 22:17:27 INFO Epoch 9: Curriculum level set to 2
2025-07-27 22:19:15 INFO Epoch 009 | Train Loss: 0.3281 | Val Loss: 0.3452 | Dice: 0.4847 | clDice: 0.5528 | IoU: 0.3201 | Tversky: 0.4847 | Hausdorff: 247.7470 | HD95: 43.7373 | LR: 0.001000
2025-07-27 22:19:15 INFO Epoch 10: Curriculum level set to 1
2025-07-27 22:21:02 INFO Epoch 010 | Train Loss: 0.3479 | Val Loss: 0.3438 | Dice: 0.4879 | clDice: 0.5543 | IoU: 0.3229 | Tversky: 0.4879 | Hausdorff: 242.9018 | HD95: 33.1872 | LR: 0.001000
2025-07-27 22:21:02 INFO Epoch 11: Curriculum level set to 1
2025-07-27 22:22:42 INFO Epoch 011 | Train Loss: 0.3493 | Val Loss: 0.3505 | Dice: 0.4834 | clDice: 0.5501 | IoU: 0.3190 | Tversky: 0.4834 | Hausdorff: 245.6116 | HD95: 32.3274 | LR: 0.001000
2025-07-27 22:22:42 INFO Epoch 12: Curriculum level set to 1
2025-07-27 22:24:28 INFO Epoch 012 | Train Loss: 0.3434 | Val Loss: 0.3460 | Dice: 0.4831 | clDice: 0.5442 | IoU: 0.3189 | Tversky: 0.4831 | Hausdorff: 244.3280 | HD95: 39.8787 | LR: 0.001000
2025-07-27 22:24:28 INFO Epoch 13: Curriculum level set to 1
2025-07-27 22:26:14 INFO Epoch 013 | Train Loss: 0.3478 | Val Loss: 0.3559 | Dice: 0.4747 | clDice: 0.5360 | IoU: 0.3114 | Tversky: 0.4747 | Hausdorff: 242.2088 | HD95: 34.6070 | LR: 0.001000
2025-07-27 22:26:14 INFO Epoch 14: Curriculum level set to 1
2025-07-27 22:28:00 INFO Epoch 014 | Train Loss: 0.3443 | Val Loss: 0.3439 | Dice: 0.4900 | clDice: 0.5552 | IoU: 0.3248 | Tversky: 0.4900 | Hausdorff: 242.6644 | HD95: 32.0024 | LR: 0.001000
2025-07-27 22:28:00 INFO Epoch 15: Curriculum level set to 0
2025-07-27 22:29:38 INFO Epoch 015 | Train Loss: 0.3733 | Val Loss: 0.3408 | Dice: 0.4866 | clDice: 0.5346 | IoU: 0.3220 | Tversky: 0.4866 | Hausdorff: 251.1442 | HD95: 39.8359 | LR: 0.001000
2025-07-27 22:29:38 INFO Epoch 16: Curriculum level set to 0
2025-07-27 22:31:21 INFO Epoch 016 | Train Loss: 0.3700 | Val Loss: 0.3390 | Dice: 0.4909 | clDice: 0.5381 | IoU: 0.3257 | Tversky: 0.4909 | Hausdorff: 249.6518 | HD95: 32.9743 | LR: 0.001000
2025-07-27 22:31:21 INFO Epoch 17: Curriculum level set to 0
2025-07-27 22:33:05 INFO Epoch 017 | Train Loss: 0.3720 | Val Loss: 0.3399 | Dice: 0.4882 | clDice: 0.5367 | IoU: 0.3235 | Tversky: 0.4882 | Hausdorff: 248.0521 | HD95: 33.8963 | LR: 0.001000
2025-07-27 22:33:05 INFO Epoch 18: Curriculum level set to 0
2025-07-27 22:34:41 INFO Epoch 018 | Train Loss: 0.3680 | Val Loss: 0.3371 | Dice: 0.4926 | clDice: 0.5415 | IoU: 0.3272 | Tversky: 0.4926 | Hausdorff: 244.6006 | HD95: 31.3302 | LR: 0.001000
2025-07-27 22:34:41 INFO Epoch 19: Curriculum level set to 0
2025-07-27 22:36:22 INFO Epoch 019 | Train Loss: 0.3681 | Val Loss: 0.3408 | Dice: 0.4849 | clDice: 0.5305 | IoU: 0.3205 | Tversky: 0.4849 | Hausdorff: 244.2464 | HD95: 32.5472 | LR: 0.001000
2025-07-27 22:36:22 INFO Epoch 20: Curriculum level set to 0
2025-07-27 22:38:04 INFO Epoch 020 | Train Loss: 0.3682 | Val Loss: 0.3408 | Dice: 0.4884 | clDice: 0.5391 | IoU: 0.3235 | Tversky: 0.4884 | Hausdorff: 259.1063 | HD95: 43.4745 | LR: 0.001000
2025-07-27 22:38:04 INFO Epoch 21: Curriculum level set to 0
2025-07-27 22:39:46 INFO Epoch 021 | Train Loss: 0.3667 | Val Loss: 0.3405 | Dice: 0.4846 | clDice: 0.5281 | IoU: 0.3202 | Tversky: 0.4846 | Hausdorff: 242.8838 | HD95: 32.4143 | LR: 0.001000
2025-07-27 22:39:46 INFO Epoch 22: Curriculum level set to 0
2025-07-27 22:41:23 INFO Epoch 022 | Train Loss: 0.3652 | Val Loss: 0.3362 | Dice: 0.4954 | clDice: 0.5458 | IoU: 0.3297 | Tversky: 0.4954 | Hausdorff: 243.2364 | HD95: 31.5748 | LR: 0.001000
2025-07-27 22:41:23 INFO Epoch 23: Curriculum level set to 0
2025-07-27 22:43:05 INFO Epoch 023 | Train Loss: 0.3674 | Val Loss: 0.3396 | Dice: 0.4871 | clDice: 0.5344 | IoU: 0.3225 | Tversky: 0.4871 | Hausdorff: 248.7777 | HD95: 36.8526 | LR: 0.001000
2025-07-27 22:43:05 INFO Epoch 24: Curriculum level set to 0
2025-07-27 22:44:50 INFO Epoch 024 | Train Loss: 0.3659 | Val Loss: 0.3403 | Dice: 0.4859 | clDice: 0.5285 | IoU: 0.3216 | Tversky: 0.4859 | Hausdorff: 234.3807 | HD95: 33.0600 | LR: 0.001000
2025-07-27 22:44:50 INFO Epoch 25: Curriculum level set to 0
2025-07-27 22:46:25 INFO Epoch 025 | Train Loss: 0.3671 | Val Loss: 0.3414 | Dice: 0.4851 | clDice: 0.5355 | IoU: 0.3207 | Tversky: 0.4851 | Hausdorff: 237.1985 | HD95: 45.5315 | LR: 0.001000
2025-07-27 22:46:25 INFO Epoch 26: Curriculum level set to 0
2025-07-27 22:48:03 INFO Epoch 026 | Train Loss: 0.3668 | Val Loss: 0.3360 | Dice: 0.4912 | clDice: 0.5355 | IoU: 0.3261 | Tversky: 0.4912 | Hausdorff: 251.2838 | HD95: 30.4186 | LR: 0.001000
2025-07-27 22:48:03 INFO Epoch 27: Curriculum level set to 0
2025-07-27 22:49:45 INFO Epoch 027 | Train Loss: 0.3665 | Val Loss: 0.3421 | Dice: 0.4827 | clDice: 0.5278 | IoU: 0.3187 | Tversky: 0.4827 | Hausdorff: 246.5996 | HD95: 40.0700 | LR: 0.001000
2025-07-27 22:49:45 INFO Epoch 28: Curriculum level set to 0
2025-07-27 22:51:30 INFO Epoch 028 | Train Loss: 0.3680 | Val Loss: 0.3374 | Dice: 0.4897 | clDice: 0.5384 | IoU: 0.3248 | Tversky: 0.4897 | Hausdorff: 245.3873 | HD95: 36.4528 | LR: 0.001000
2025-07-27 22:51:30 INFO Epoch 29: Curriculum level set to 0
2025-07-27 22:53:05 INFO Epoch 029 | Train Loss: 0.3654 | Val Loss: 0.3387 | Dice: 0.4885 | clDice: 0.5338 | IoU: 0.3236 | Tversky: 0.4885 | Hausdorff: 242.5032 | HD95: 32.4217 | LR: 0.001000
2025-07-27 22:53:05 INFO Epoch 30: Curriculum level set to 0
2025-07-27 22:54:45 INFO Epoch 030 | Train Loss: 0.3628 | Val Loss: 0.3402 | Dice: 0.4879 | clDice: 0.5377 | IoU: 0.3229 | Tversky: 0.4879 | Hausdorff: 246.2676 | HD95: 36.1569 | LR: 0.001000
2025-07-27 22:54:45 INFO Epoch 31: Curriculum level set to 0
2025-07-27 22:56:29 INFO Epoch 031 | Train Loss: 0.3643 | Val Loss: 0.3391 | Dice: 0.4889 | clDice: 0.5381 | IoU: 0.3240 | Tversky: 0.4889 | Hausdorff: 245.9581 | HD95: 36.8015 | LR: 0.001000
2025-07-27 22:56:29 INFO Epoch 32: Curriculum level set to 0
2025-07-27 22:58:10 INFO Epoch 032 | Train Loss: 0.3650 | Val Loss: 0.3361 | Dice: 0.4924 | clDice: 0.5440 | IoU: 0.3269 | Tversky: 0.4924 | Hausdorff: 262.4802 | HD95: 37.9670 | LR: 0.001000
2025-07-27 22:58:10 INFO Epoch 33: Curriculum level set to 0
2025-07-27 22:59:48 INFO Epoch 033 | Train Loss: 0.3637 | Val Loss: 0.3408 | Dice: 0.4830 | clDice: 0.5305 | IoU: 0.3186 | Tversky: 0.4830 | Hausdorff: 251.0250 | HD95: 41.2886 | LR: 0.001000
2025-07-27 22:59:48 INFO Epoch 34: Curriculum level set to 0
2025-07-27 23:01:32 INFO Epoch 034 | Train Loss: 0.3628 | Val Loss: 0.3396 | Dice: 0.4835 | clDice: 0.5257 | IoU: 0.3192 | Tversky: 0.4835 | Hausdorff: 239.0471 | HD95: 37.0466 | LR: 0.001000
2025-07-27 23:01:32 INFO Epoch 35: Curriculum level set to 0
2025-07-27 23:03:16 INFO Epoch 035 | Train Loss: 0.3632 | Val Loss: 0.3359 | Dice: 0.4929 | clDice: 0.5421 | IoU: 0.3276 | Tversky: 0.4929 | Hausdorff: 244.5094 | HD95: 34.3510 | LR: 0.001000
2025-07-27 23:03:16 INFO Epoch 36: Curriculum level set to 0
2025-07-27 23:04:50 INFO Epoch 036 | Train Loss: 0.3607 | Val Loss: 0.3530 | Dice: 0.4541 | clDice: 0.4921 | IoU: 0.2940 | Tversky: 0.4541 | Hausdorff: 510.5160 | HD95: 58.4079 | LR: 0.001000
2025-07-27 23:04:50 INFO Epoch 37: Curriculum level set to 0
2025-07-27 23:06:29 INFO Epoch 037 | Train Loss: 0.3643 | Val Loss: 0.3359 | Dice: 0.4885 | clDice: 0.5349 | IoU: 0.3238 | Tversky: 0.4885 | Hausdorff: 512.9153 | HD95: 35.5257 | LR: 0.001000
2025-07-27 23:06:29 INFO Epoch 38: Curriculum level set to 0
2025-07-27 23:08:13 INFO Epoch 038 | Train Loss: 0.3618 | Val Loss: 0.3367 | Dice: 0.4941 | clDice: 0.5462 | IoU: 0.3285 | Tversky: 0.4941 | Hausdorff: 242.9011 | HD95: 32.6817 | LR: 0.001000
2025-07-27 23:08:13 INFO Epoch 39: Curriculum level set to 0
2025-07-27 23:09:57 INFO Epoch 039 | Train Loss: 0.3604 | Val Loss: 0.3379 | Dice: 0.4894 | clDice: 0.5387 | IoU: 0.3244 | Tversky: 0.4894 | Hausdorff: 239.9332 | HD95: 32.7490 | LR: 0.001000
2025-07-27 23:09:57 INFO Epoch 40: Curriculum level set to 0
2025-07-27 23:11:33 INFO Epoch 040 | Train Loss: 0.3612 | Val Loss: 0.3366 | Dice: 0.4905 | clDice: 0.5352 | IoU: 0.3253 | Tversky: 0.4905 | Hausdorff: 241.2403 | HD95: 35.2352 | LR: 0.001000
2025-07-27 23:11:33 INFO Epoch 41: Curriculum level set to 0
2025-07-27 23:13:13 INFO Epoch 041 | Train Loss: 0.3582 | Val Loss: 0.3373 | Dice: 0.4910 | clDice: 0.5374 | IoU: 0.3258 | Tversky: 0.4910 | Hausdorff: 232.0996 | HD95: 30.5413 | LR: 0.001000
2025-07-27 23:13:13 INFO Epoch 42: Curriculum level set to 0
2025-07-27 23:14:56 INFO Epoch 042 | Train Loss: 0.3602 | Val Loss: 0.3418 | Dice: 0.4809 | clDice: 0.5271 | IoU: 0.3169 | Tversky: 0.4809 | Hausdorff: 242.1498 | HD95: 39.5968 | LR: 0.001000
2025-07-27 23:14:56 INFO Epoch 43: Curriculum level set to 0
2025-07-27 23:16:39 INFO Epoch 043 | Train Loss: 0.3590 | Val Loss: 0.3400 | Dice: 0.4849 | clDice: 0.5289 | IoU: 0.3204 | Tversky: 0.4849 | Hausdorff: 244.9489 | HD95: 39.3293 | LR: 0.001000
2025-07-27 23:16:39 INFO Epoch 44: Curriculum level set to 0
2025-07-27 23:18:15 INFO Epoch 044 | Train Loss: 0.3586 | Val Loss: 0.3388 | Dice: 0.4927 | clDice: 0.5430 | IoU: 0.3273 | Tversky: 0.4927 | Hausdorff: 239.4484 | HD95: 33.2016 | LR: 0.001000
2025-07-27 23:18:15 INFO Epoch 45: Curriculum level set to 0
2025-07-27 23:19:58 INFO Epoch 045 | Train Loss: 0.3588 | Val Loss: 0.3376 | Dice: 0.4907 | clDice: 0.5408 | IoU: 0.3256 | Tversky: 0.4907 | Hausdorff: 248.0704 | HD95: 37.9221 | LR: 0.001000
2025-07-27 23:19:58 INFO Epoch 46: Curriculum level set to 0
2025-07-27 23:21:40 INFO Epoch 046 | Train Loss: 0.3572 | Val Loss: 0.3381 | Dice: 0.4846 | clDice: 0.5280 | IoU: 0.3203 | Tversky: 0.4846 | Hausdorff: 227.7049 | HD95: 38.0956 | LR: 0.000500
2025-07-27 23:21:40 INFO Epoch 47: Curriculum level set to 0
2025-07-27 23:23:15 INFO Early stopping at epoch 47 | Best Dice: 0.4954 at epoch 37
2025-07-27 23:23:45 INFO Test Loss: 0.3359 | Dice: 0.4885 | clDice: 0.5349 | IoU: 0.3238 | Tversky: 0.4885 | Hausdorff: 512.9153 | HD95: 35.5257
