/data/smadper@alumno.upv.es/TFM/env/lib/python3.8/site-packages/albumentations/__init__.py:13: UserWarning: A new version of Albumentations is available: 2.0.8 (you have 1.4.18). Upgrade using: pip install -U albumentations. To disable automatic update checks, set the environment variable NO_ALBUMENTATIONS_UPDATE to 1.
  check_for_updates()
2025-07-20 21:51:18 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_resnet18', 'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 2, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'image_size': [512, 512], 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'sato': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/sato_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 50, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints', 'log_interval': 1, 'patience': 10, 'experiment_name': 'unet_sato_resnet18_dropout', 'timestamp': '20250720_215118'}, 'test': {'batch_size': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/results'}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 0.5, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-20 21:51:18 INFO Experiment name: unet_sato_resnet18_dropout
2025-07-20 21:51:18 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_resnet18', 'encoder_name': 'resnet18', 'encoder_weights': 'imagenet', 'in_channels': 2, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
/data/smadper@alumno.upv.es/TFM/src/datasets.py:240: UserWarning: Argument 'alpha_affine' is not valid and will be ignored.
  A.ElasticTransform(alpha=120, sigma=120 * 0.05, alpha_affine=120 * 0.03, p=0.3),
2025-07-20 21:52:25 INFO Epoch 001 | Train Loss: 0.5875 | Val Loss: 0.4996 | Dice: 0.2968 | clDice: 0.3567 |IoU: 0.1746 | LR: 0.001000
2025-07-20 21:53:33 INFO Epoch 002 | Train Loss: 0.5012 | Val Loss: 0.4066 | Dice: 0.3995 | clDice: 0.4539 |IoU: 0.2498 | LR: 0.001000
2025-07-20 21:54:41 INFO Epoch 003 | Train Loss: 0.4849 | Val Loss: 0.4007 | Dice: 0.4310 | clDice: 0.4705 |IoU: 0.2748 | LR: 0.001000
2025-07-20 21:55:51 INFO Epoch 004 | Train Loss: 0.4790 | Val Loss: 0.4131 | Dice: 0.4143 | clDice: 0.4848 |IoU: 0.2613 | LR: 0.001000
2025-07-20 21:57:01 INFO Epoch 005 | Train Loss: 0.4769 | Val Loss: 0.3818 | Dice: 0.4356 | clDice: 0.4716 |IoU: 0.2785 | LR: 0.001000
2025-07-20 21:58:07 INFO Epoch 006 | Train Loss: 0.4713 | Val Loss: 0.3790 | Dice: 0.4273 | clDice: 0.4585 |IoU: 0.2718 | LR: 0.001000
2025-07-20 21:59:17 INFO Epoch 007 | Train Loss: 0.4723 | Val Loss: 0.3846 | Dice: 0.4231 | clDice: 0.4580 |IoU: 0.2684 | LR: 0.001000
2025-07-20 22:00:25 INFO Epoch 008 | Train Loss: 0.4684 | Val Loss: 0.3674 | Dice: 0.4543 | clDice: 0.4928 |IoU: 0.2940 | LR: 0.001000
2025-07-20 22:01:31 INFO Epoch 009 | Train Loss: 0.4680 | Val Loss: 0.3790 | Dice: 0.4533 | clDice: 0.5050 |IoU: 0.2932 | LR: 0.001000
2025-07-20 22:02:41 INFO Epoch 010 | Train Loss: 0.4642 | Val Loss: 0.3716 | Dice: 0.4515 | clDice: 0.4862 |IoU: 0.2917 | LR: 0.001000
2025-07-20 22:03:50 INFO Epoch 011 | Train Loss: 0.4598 | Val Loss: 0.3671 | Dice: 0.4641 | clDice: 0.5107 |IoU: 0.3023 | LR: 0.001000
2025-07-20 22:04:58 INFO Epoch 012 | Train Loss: 0.4604 | Val Loss: 0.3668 | Dice: 0.4671 | clDice: 0.5103 |IoU: 0.3050 | LR: 0.001000
2025-07-20 22:06:03 INFO Epoch 013 | Train Loss: 0.4608 | Val Loss: 0.3591 | Dice: 0.4592 | clDice: 0.5036 |IoU: 0.2981 | LR: 0.001000
2025-07-20 22:07:11 INFO Epoch 014 | Train Loss: 0.4619 | Val Loss: 0.3617 | Dice: 0.4655 | clDice: 0.5020 |IoU: 0.3037 | LR: 0.001000
2025-07-20 22:08:18 INFO Epoch 015 | Train Loss: 0.4539 | Val Loss: 0.3584 | Dice: 0.4688 | clDice: 0.5184 |IoU: 0.3064 | LR: 0.001000
2025-07-20 22:09:25 INFO Epoch 016 | Train Loss: 0.4536 | Val Loss: 0.3580 | Dice: 0.4735 | clDice: 0.5295 |IoU: 0.3104 | LR: 0.001000
2025-07-20 22:10:35 INFO Epoch 017 | Train Loss: 0.4519 | Val Loss: 0.3515 | Dice: 0.4722 | clDice: 0.5106 |IoU: 0.3094 | LR: 0.001000
2025-07-20 22:11:48 INFO Epoch 018 | Train Loss: 0.4531 | Val Loss: 0.3583 | Dice: 0.4743 | clDice: 0.5130 |IoU: 0.3112 | LR: 0.001000
2025-07-20 22:12:55 INFO Epoch 019 | Train Loss: 0.4487 | Val Loss: 0.3628 | Dice: 0.4676 | clDice: 0.4990 |IoU: 0.3055 | LR: 0.001000
2025-07-20 22:14:04 INFO Epoch 020 | Train Loss: 0.4493 | Val Loss: 0.3522 | Dice: 0.4724 | clDice: 0.5085 |IoU: 0.3095 | LR: 0.001000
2025-07-20 22:15:16 INFO Epoch 021 | Train Loss: 0.4470 | Val Loss: 0.3550 | Dice: 0.4716 | clDice: 0.5185 |IoU: 0.3087 | LR: 0.001000
2025-07-20 22:16:21 INFO Epoch 022 | Train Loss: 0.4468 | Val Loss: 0.3624 | Dice: 0.4712 | clDice: 0.4939 |IoU: 0.3086 | LR: 0.001000
2025-07-20 22:17:28 INFO Epoch 023 | Train Loss: 0.4500 | Val Loss: 0.3623 | Dice: 0.4659 | clDice: 0.5142 |IoU: 0.3039 | LR: 0.001000
2025-07-20 22:18:39 INFO Epoch 024 | Train Loss: 0.4518 | Val Loss: 0.3514 | Dice: 0.4775 | clDice: 0.5122 |IoU: 0.3139 | LR: 0.001000
2025-07-20 22:19:47 INFO Epoch 025 | Train Loss: 0.4515 | Val Loss: 0.3517 | Dice: 0.4789 | clDice: 0.5249 |IoU: 0.3152 | LR: 0.001000
2025-07-20 22:20:55 INFO Epoch 026 | Train Loss: 0.4470 | Val Loss: 0.3478 | Dice: 0.4854 | clDice: 0.5264 |IoU: 0.3207 | LR: 0.001000
2025-07-20 22:22:02 INFO Epoch 027 | Train Loss: 0.4457 | Val Loss: 0.3547 | Dice: 0.4728 | clDice: 0.5037 |IoU: 0.3099 | LR: 0.001000
2025-07-20 22:23:07 INFO Epoch 028 | Train Loss: 0.4443 | Val Loss: 0.3550 | Dice: 0.4777 | clDice: 0.5284 |IoU: 0.3140 | LR: 0.001000
2025-07-20 22:24:15 INFO Epoch 029 | Train Loss: 0.4441 | Val Loss: 0.3534 | Dice: 0.4652 | clDice: 0.4965 |IoU: 0.3036 | LR: 0.001000
2025-07-20 22:25:23 INFO Epoch 030 | Train Loss: 0.4445 | Val Loss: 0.3445 | Dice: 0.4831 | clDice: 0.5219 |IoU: 0.3188 | LR: 0.001000
2025-07-20 22:26:34 INFO Epoch 031 | Train Loss: 0.4431 | Val Loss: 0.3438 | Dice: 0.4847 | clDice: 0.5139 |IoU: 0.3202 | LR: 0.001000
2025-07-20 22:27:41 INFO Epoch 032 | Train Loss: 0.4389 | Val Loss: 0.3454 | Dice: 0.4818 | clDice: 0.5172 |IoU: 0.3177 | LR: 0.001000
2025-07-20 22:28:49 INFO Epoch 033 | Train Loss: 0.4407 | Val Loss: 0.3517 | Dice: 0.4883 | clDice: 0.5273 |IoU: 0.3233 | LR: 0.001000
2025-07-20 22:29:59 INFO Epoch 034 | Train Loss: 0.4378 | Val Loss: 0.3460 | Dice: 0.4894 | clDice: 0.5356 |IoU: 0.3243 | LR: 0.001000
2025-07-20 22:31:06 INFO Epoch 035 | Train Loss: 0.4438 | Val Loss: 0.3724 | Dice: 0.4624 | clDice: 0.5269 |IoU: 0.3010 | LR: 0.001000
2025-07-20 22:32:13 INFO Epoch 036 | Train Loss: 0.4379 | Val Loss: 0.3440 | Dice: 0.4865 | clDice: 0.5188 |IoU: 0.3218 | LR: 0.001000
2025-07-20 22:33:26 INFO Epoch 037 | Train Loss: 0.4431 | Val Loss: 0.3424 | Dice: 0.4838 | clDice: 0.5219 |IoU: 0.3193 | LR: 0.001000
2025-07-20 22:34:33 INFO Epoch 038 | Train Loss: 0.4420 | Val Loss: 0.3528 | Dice: 0.4683 | clDice: 0.4912 |IoU: 0.3061 | LR: 0.001000
2025-07-20 22:35:41 INFO Epoch 039 | Train Loss: 0.4357 | Val Loss: 0.3438 | Dice: 0.4865 | clDice: 0.5235 |IoU: 0.3218 | LR: 0.001000
2025-07-20 22:36:50 INFO Epoch 040 | Train Loss: 0.4386 | Val Loss: 0.3459 | Dice: 0.4801 | clDice: 0.5267 |IoU: 0.3164 | LR: 0.001000
2025-07-20 22:37:57 INFO Epoch 041 | Train Loss: 0.4335 | Val Loss: 0.3476 | Dice: 0.4874 | clDice: 0.5285 |IoU: 0.3225 | LR: 0.001000
2025-07-20 22:39:04 INFO Epoch 042 | Train Loss: 0.4352 | Val Loss: 0.3437 | Dice: 0.4845 | clDice: 0.5224 |IoU: 0.3200 | LR: 0.001000
2025-07-20 22:40:12 INFO Epoch 043 | Train Loss: 0.4365 | Val Loss: 0.3464 | Dice: 0.4844 | clDice: 0.5167 |IoU: 0.3200 | LR: 0.001000
2025-07-20 22:41:19 INFO Epoch 044 | Train Loss: 0.4351 | Val Loss: 0.3423 | Dice: 0.4882 | clDice: 0.5261 |IoU: 0.3232 | LR: 0.001000
2025-07-20 22:42:26 INFO Epoch 045 | Train Loss: 0.4404 | Val Loss: 0.3533 | Dice: 0.4782 | clDice: 0.5037 |IoU: 0.3147 | LR: 0.001000
2025-07-20 22:43:34 INFO Epoch 046 | Train Loss: 0.4380 | Val Loss: 0.3508 | Dice: 0.4793 | clDice: 0.5040 |IoU: 0.3157 | LR: 0.001000
2025-07-20 22:44:42 INFO Epoch 047 | Train Loss: 0.4382 | Val Loss: 0.3470 | Dice: 0.4879 | clDice: 0.5307 |IoU: 0.3230 | LR: 0.001000
2025-07-20 22:45:46 INFO Epoch 048 | Train Loss: 0.4393 | Val Loss: 0.3435 | Dice: 0.4902 | clDice: 0.5316 |IoU: 0.3250 | LR: 0.001000
2025-07-20 22:46:53 INFO Epoch 049 | Train Loss: 0.4374 | Val Loss: 0.3419 | Dice: 0.4927 | clDice: 0.5329 |IoU: 0.3273 | LR: 0.001000
2025-07-20 22:48:02 INFO Epoch 050 | Train Loss: 0.4327 | Val Loss: 0.3445 | Dice: 0.4891 | clDice: 0.5333 |IoU: 0.3239 | LR: 0.001000
2025-07-20 22:48:02 INFO Training completed.
2025-07-20 22:48:16 INFO Test Loss: 0.3419 | Dice: 0.4927 | IoU: 0.3273 | clDice: 0.5329
