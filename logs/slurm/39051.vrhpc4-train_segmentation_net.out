2025-07-23 00:55:49 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 1, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_005549_unet_timm-resnest50d_bce_dice', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_timm-resnest50d_bce_dice', 'timestamp': '20250723_005549'}, 'test': {'batch_size': 1}, 'loss': {'name': 'bce', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 00:55:49 INFO Experiment name: unet_timm-resnest50d_bce_dice
2025-07-23 00:55:49 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 00:55:49 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 00:55:49 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 00:55:49 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 00:55:49 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 00:57:10 INFO Epoch 001 | Train Loss: 1.1127 | Val Loss: 0.8661 | Dice: 0.3902 | clDice: 0.4173 | IoU: 0.2429 | Tversky: 0.3902 | Hausdorff: 672.0728 | HD95: 86.2128 | LR: 0.001000
2025-07-23 00:57:10 INFO Training completed.
2025-07-23 00:57:47 INFO Test Loss: 0.8661 | Dice: 0.3902 | clDice: 0.4173 | IoU: 0.2429 | Tversky: 0.3902 | Hausdorff: 672.0728 | HD95: 86.2128
