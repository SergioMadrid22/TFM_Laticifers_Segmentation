2025-07-23 06:05:09 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_060509_unet_densenet121_clahe_otsu', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_densenet121_clahe_otsu', 'timestamp': '20250723_060509'}, 'test': {'batch_size': 1}, 'loss': {'name': 'hausdorff', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 06:05:09 INFO Experiment name: unet_densenet121_clahe_otsu
2025-07-23 06:05:09 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 06:05:09 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 06:05:09 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 06:05:09 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 06:05:10 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 06:07:54 INFO Epoch 001 | Train Loss: 17.4629 | Val Loss: 9.3875 | Dice: 0.3428 | clDice: 0.3679 | IoU: 0.2072 | Tversky: 0.3428 | Hausdorff: 320.0140 | HD95: 139.8833 | LR: 0.001000
2025-07-23 06:10:34 INFO Epoch 002 | Train Loss: 13.2137 | Val Loss: 8.7874 | Dice: 0.3471 | clDice: 0.3739 | IoU: 0.2110 | Tversky: 0.3471 | Hausdorff: 424.1413 | HD95: 133.3890 | LR: 0.001000
2025-07-23 06:13:13 INFO Epoch 003 | Train Loss: 13.1606 | Val Loss: 8.6691 | Dice: 0.4029 | clDice: 0.4325 | IoU: 0.2527 | Tversky: 0.4029 | Hausdorff: 311.3411 | HD95: 106.0140 | LR: 0.001000
2025-07-23 06:15:53 INFO Epoch 004 | Train Loss: 13.2149 | Val Loss: 8.6307 | Dice: 0.3757 | clDice: 0.4064 | IoU: 0.2314 | Tversky: 0.3757 | Hausdorff: 325.9325 | HD95: 114.3475 | LR: 0.001000
2025-07-23 06:18:31 INFO Epoch 005 | Train Loss: 13.1714 | Val Loss: 8.5946 | Dice: 0.4142 | clDice: 0.4471 | IoU: 0.2617 | Tversky: 0.4142 | Hausdorff: 302.8155 | HD95: 88.7736 | LR: 0.001000
2025-07-23 06:21:14 INFO Epoch 006 | Train Loss: 13.0718 | Val Loss: 8.6181 | Dice: 0.3837 | clDice: 0.4144 | IoU: 0.2375 | Tversky: 0.3837 | Hausdorff: 352.0195 | HD95: 96.7967 | LR: 0.001000
2025-07-23 06:23:58 INFO Epoch 007 | Train Loss: 13.0525 | Val Loss: 8.5809 | Dice: 0.4343 | clDice: 0.4728 | IoU: 0.2778 | Tversky: 0.4343 | Hausdorff: 334.5351 | HD95: 89.5355 | LR: 0.001000
2025-07-23 06:26:43 INFO Epoch 008 | Train Loss: 13.0537 | Val Loss: 8.5624 | Dice: 0.4103 | clDice: 0.4456 | IoU: 0.2586 | Tversky: 0.4103 | Hausdorff: 322.4609 | HD95: 103.0368 | LR: 0.001000
2025-07-23 06:29:20 INFO Epoch 009 | Train Loss: 12.9946 | Val Loss: 8.6093 | Dice: 0.3552 | clDice: 0.3781 | IoU: 0.2165 | Tversky: 0.3552 | Hausdorff: 418.1761 | HD95: 156.3875 | LR: 0.001000
2025-07-23 06:32:01 INFO Epoch 010 | Train Loss: 12.9613 | Val Loss: 8.5935 | Dice: 0.3489 | clDice: 0.3779 | IoU: 0.2113 | Tversky: 0.3489 | Hausdorff: 527.0795 | HD95: 194.2170 | LR: 0.001000
2025-07-23 06:34:44 INFO Epoch 011 | Train Loss: 13.0827 | Val Loss: 8.6225 | Dice: 0.3030 | clDice: 0.3164 | IoU: 0.1789 | Tversky: 0.3030 | Hausdorff: 676.6892 | HD95: 256.6321 | LR: 0.001000
2025-07-23 06:37:22 INFO Epoch 012 | Train Loss: 13.1315 | Val Loss: 8.5907 | Dice: 0.3700 | clDice: 0.3988 | IoU: 0.2280 | Tversky: 0.3700 | Hausdorff: 405.5401 | HD95: 160.1754 | LR: 0.001000
2025-07-23 06:40:06 INFO Epoch 013 | Train Loss: 12.9984 | Val Loss: 8.5643 | Dice: 0.3730 | clDice: 0.4042 | IoU: 0.2300 | Tversky: 0.3730 | Hausdorff: 349.5110 | HD95: 134.9836 | LR: 0.001000
2025-07-23 06:42:46 INFO Epoch 014 | Train Loss: 12.9815 | Val Loss: 8.5403 | Dice: 0.4321 | clDice: 0.4677 | IoU: 0.2761 | Tversky: 0.4321 | Hausdorff: 309.6187 | HD95: 91.3358 | LR: 0.001000
2025-07-23 06:45:28 INFO Epoch 015 | Train Loss: 12.9448 | Val Loss: 8.5842 | Dice: 0.4185 | clDice: 0.4493 | IoU: 0.2648 | Tversky: 0.4185 | Hausdorff: 284.0361 | HD95: 88.6584 | LR: 0.001000
2025-07-23 06:48:08 INFO Epoch 016 | Train Loss: 13.0517 | Val Loss: 8.5522 | Dice: 0.4166 | clDice: 0.4485 | IoU: 0.2637 | Tversky: 0.4166 | Hausdorff: 342.2689 | HD95: 96.9257 | LR: 0.001000
2025-07-23 06:50:41 INFO Epoch 017 | Train Loss: 13.0229 | Val Loss: 8.5506 | Dice: 0.3948 | clDice: 0.4200 | IoU: 0.2464 | Tversky: 0.3948 | Hausdorff: 300.1395 | HD95: 102.9776 | LR: 0.001000
2025-07-23 06:53:25 INFO Epoch 018 | Train Loss: 12.8238 | Val Loss: 8.5334 | Dice: 0.4260 | clDice: 0.4586 | IoU: 0.2710 | Tversky: 0.4260 | Hausdorff: 383.4093 | HD95: 91.4144 | LR: 0.001000
2025-07-23 06:56:00 INFO Epoch 019 | Train Loss: 12.8082 | Val Loss: 8.5380 | Dice: 0.4045 | clDice: 0.4362 | IoU: 0.2536 | Tversky: 0.4045 | Hausdorff: 350.3954 | HD95: 117.4619 | LR: 0.001000
2025-07-23 06:58:39 INFO Epoch 020 | Train Loss: 13.0912 | Val Loss: 8.5632 | Dice: 0.3999 | clDice: 0.4283 | IoU: 0.2503 | Tversky: 0.3999 | Hausdorff: 299.3991 | HD95: 108.5711 | LR: 0.001000
2025-07-23 07:01:16 INFO Epoch 021 | Train Loss: 12.8963 | Val Loss: 8.5526 | Dice: 0.4247 | clDice: 0.4630 | IoU: 0.2700 | Tversky: 0.4247 | Hausdorff: 302.4229 | HD95: 102.0336 | LR: 0.001000
2025-07-23 07:03:55 INFO Epoch 022 | Train Loss: 13.0270 | Val Loss: 8.5366 | Dice: 0.4436 | clDice: 0.4833 | IoU: 0.2852 | Tversky: 0.4436 | Hausdorff: 308.4422 | HD95: 91.1359 | LR: 0.001000
2025-07-23 07:06:39 INFO Epoch 023 | Train Loss: 13.0406 | Val Loss: 8.5668 | Dice: 0.3466 | clDice: 0.3724 | IoU: 0.2098 | Tversky: 0.3466 | Hausdorff: 572.6602 | HD95: 224.0008 | LR: 0.001000
2025-07-23 07:09:22 INFO Epoch 024 | Train Loss: 12.7464 | Val Loss: 8.5518 | Dice: 0.3944 | clDice: 0.4290 | IoU: 0.2465 | Tversky: 0.3944 | Hausdorff: 383.5359 | HD95: 123.5050 | LR: 0.001000
2025-07-23 07:12:00 INFO Epoch 025 | Train Loss: 13.1211 | Val Loss: 8.5429 | Dice: 0.2443 | clDice: 0.2520 | IoU: 0.1394 | Tversky: 0.2443 | Hausdorff: 499.9876 | HD95: 208.1996 | LR: 0.001000
2025-07-23 07:14:31 INFO Epoch 026 | Train Loss: 12.8545 | Val Loss: 8.5502 | Dice: 0.3941 | clDice: 0.4227 | IoU: 0.2462 | Tversky: 0.3941 | Hausdorff: 377.9288 | HD95: 109.6351 | LR: 0.001000
2025-07-23 07:17:17 INFO Epoch 027 | Train Loss: 12.9952 | Val Loss: 8.5389 | Dice: 0.4101 | clDice: 0.4398 | IoU: 0.2582 | Tversky: 0.4101 | Hausdorff: 330.6685 | HD95: 100.9109 | LR: 0.001000
2025-07-23 07:19:57 INFO Early stopping at epoch 28 | Best Dice: 0.4436 at epoch 18
2025-07-23 07:20:38 INFO Test Loss: 8.5334 | Dice: 0.4260 | clDice: 0.4586 | IoU: 0.2710 | Tversky: 0.4260 | Hausdorff: 383.4093 | HD95: 91.4144
