2025-07-23 06:47:54 INFO Starting training with configuration: {'model': {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 40, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 4, 'positive_ratio': 0.8, 'fg_threshold': 0.04, 'dist_transform': True, 'feature_dirs': {'enhanced': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 16, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints/unet/20250723_064754_unet_efficientnet-b4_clahe_otsu', 'log_interval': 1, 'patience': 10, 'mixed_precision': True, 'experiment_name': 'unet_efficientnet-b4_clahe_otsu', 'timestamp': '20250723_064754'}, 'test': {'batch_size': 1}, 'loss': {'name': 'hausdorff', 'cldice_alpha': 0.3, 'use_topographic': False, 'combine_with': 'dice', 'weights': {'main': 1, 'combined': 1}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-07-23 06:47:54 INFO Experiment name: unet_efficientnet-b4_clahe_otsu
2025-07-23 06:47:54 INFO Loading model unet with settings {'name': 'unet', 'alias': 'unet_timm-resnest50d', 'encoder_name': 'timm-resnest50d', 'encoder_weights': 'imagenet', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.2}
2025-07-23 06:47:54 INFO Loading pretrained weights from Hugging Face hub (timm/resnest50d.in1k)
2025-07-23 06:47:54 INFO [timm/resnest50d.in1k] Safe alternative available for 'pytorch_model.bin' (as 'model.safetensors'). Loading weights using safetensors.
2025-07-23 06:47:54 INFO Converted input conv conv1.0 pretrained weights from 3 to 1 channel(s)
2025-07-23 06:47:55 INFO Missing keys (fc.weight, fc.bias) discovered while loading pretrained weights. This is expected if model is being adapted.
2025-07-23 06:50:21 INFO Epoch 001 | Train Loss: 17.3431 | Val Loss: 9.5403 | Dice: 0.2036 | clDice: 0.1969 | IoU: 0.1135 | Tversky: 0.2036 | Hausdorff: 794.3165 | HD95: 221.7904 | LR: 0.001000
2025-07-23 06:52:45 INFO Epoch 002 | Train Loss: 13.3832 | Val Loss: 8.8710 | Dice: 0.2182 | clDice: 0.2289 | IoU: 0.1227 | Tversky: 0.2182 | Hausdorff: 570.6573 | HD95: 246.7498 | LR: 0.001000
2025-07-23 06:55:08 INFO Epoch 003 | Train Loss: 13.2029 | Val Loss: 8.7806 | Dice: 0.2356 | clDice: 0.2469 | IoU: 0.1341 | Tversky: 0.2356 | Hausdorff: 555.5592 | HD95: 223.2448 | LR: 0.001000
2025-07-23 06:57:31 INFO Epoch 004 | Train Loss: 13.2496 | Val Loss: 8.6749 | Dice: 0.3072 | clDice: 0.3269 | IoU: 0.1818 | Tversky: 0.3072 | Hausdorff: 529.6952 | HD95: 203.9889 | LR: 0.001000
2025-07-23 06:59:57 INFO Epoch 005 | Train Loss: 13.2530 | Val Loss: 8.6698 | Dice: 0.3009 | clDice: 0.3140 | IoU: 0.1772 | Tversky: 0.3009 | Hausdorff: 442.6273 | HD95: 188.5618 | LR: 0.001000
2025-07-23 07:02:26 INFO Epoch 006 | Train Loss: 13.0618 | Val Loss: 8.5941 | Dice: 0.3834 | clDice: 0.4156 | IoU: 0.2373 | Tversky: 0.3834 | Hausdorff: 486.0744 | HD95: 139.2174 | LR: 0.001000
2025-07-23 07:04:57 INFO Epoch 007 | Train Loss: 13.0649 | Val Loss: 8.6324 | Dice: 0.3837 | clDice: 0.4140 | IoU: 0.2379 | Tversky: 0.3837 | Hausdorff: 483.5123 | HD95: 149.0578 | LR: 0.001000
2025-07-23 07:07:20 INFO Epoch 008 | Train Loss: 13.1275 | Val Loss: 8.5915 | Dice: 0.3815 | clDice: 0.4135 | IoU: 0.2359 | Tversky: 0.3815 | Hausdorff: 395.5269 | HD95: 134.4353 | LR: 0.001000
2025-07-23 07:09:39 INFO Epoch 009 | Train Loss: 13.1035 | Val Loss: 8.5597 | Dice: 0.4240 | clDice: 0.4607 | IoU: 0.2691 | Tversky: 0.4240 | Hausdorff: 302.0211 | HD95: 95.9268 | LR: 0.001000
2025-07-23 07:12:10 INFO Epoch 010 | Train Loss: 12.9592 | Val Loss: 8.5617 | Dice: 0.4022 | clDice: 0.4354 | IoU: 0.2521 | Tversky: 0.4022 | Hausdorff: 357.3808 | HD95: 112.8593 | LR: 0.001000
2025-07-23 07:14:31 INFO Epoch 011 | Train Loss: 13.0849 | Val Loss: 8.5710 | Dice: 0.4204 | clDice: 0.4591 | IoU: 0.2663 | Tversky: 0.4204 | Hausdorff: 320.1883 | HD95: 99.5976 | LR: 0.001000
2025-07-23 07:16:50 INFO Epoch 012 | Train Loss: 13.1780 | Val Loss: 8.5606 | Dice: 0.3859 | clDice: 0.4125 | IoU: 0.2393 | Tversky: 0.3859 | Hausdorff: 339.8142 | HD95: 115.2666 | LR: 0.001000
2025-07-23 07:19:05 INFO Epoch 013 | Train Loss: 13.0090 | Val Loss: 8.6500 | Dice: 0.3504 | clDice: 0.3769 | IoU: 0.2129 | Tversky: 0.3504 | Hausdorff: 455.4727 | HD95: 148.6545 | LR: 0.001000
2025-07-23 07:21:24 INFO Epoch 014 | Train Loss: 13.0700 | Val Loss: 8.5644 | Dice: 0.4404 | clDice: 0.4793 | IoU: 0.2829 | Tversky: 0.4404 | Hausdorff: 303.8448 | HD95: 78.9173 | LR: 0.001000
2025-07-23 07:23:42 INFO Epoch 015 | Train Loss: 12.9534 | Val Loss: 8.5763 | Dice: 0.3617 | clDice: 0.3849 | IoU: 0.2209 | Tversky: 0.3617 | Hausdorff: 477.6679 | HD95: 180.2856 | LR: 0.001000
2025-07-23 07:26:02 INFO Epoch 016 | Train Loss: 13.0577 | Val Loss: 8.5314 | Dice: 0.4161 | clDice: 0.4501 | IoU: 0.2629 | Tversky: 0.4161 | Hausdorff: 323.6291 | HD95: 118.6860 | LR: 0.001000
2025-07-23 07:28:15 INFO Epoch 017 | Train Loss: 13.0287 | Val Loss: 8.5456 | Dice: 0.4039 | clDice: 0.4341 | IoU: 0.2534 | Tversky: 0.4039 | Hausdorff: 344.5398 | HD95: 110.5654 | LR: 0.001000
2025-07-23 07:30:27 INFO Epoch 018 | Train Loss: 12.8362 | Val Loss: 8.5672 | Dice: 0.3994 | clDice: 0.4319 | IoU: 0.2500 | Tversky: 0.3994 | Hausdorff: 406.3067 | HD95: 131.2244 | LR: 0.001000
2025-07-23 07:32:45 INFO Epoch 019 | Train Loss: 12.8405 | Val Loss: 8.6054 | Dice: 0.3397 | clDice: 0.3660 | IoU: 0.2054 | Tversky: 0.3397 | Hausdorff: 384.2159 | HD95: 191.3180 | LR: 0.001000
2025-07-23 07:35:05 INFO Epoch 020 | Train Loss: 13.0808 | Val Loss: 8.5644 | Dice: 0.4361 | clDice: 0.4757 | IoU: 0.2791 | Tversky: 0.4361 | Hausdorff: 298.1246 | HD95: 85.7865 | LR: 0.001000
2025-07-23 07:37:23 INFO Epoch 021 | Train Loss: 12.8421 | Val Loss: 8.5603 | Dice: 0.4235 | clDice: 0.4656 | IoU: 0.2696 | Tversky: 0.4235 | Hausdorff: 431.8416 | HD95: 132.8973 | LR: 0.001000
2025-07-23 07:39:36 INFO Epoch 022 | Train Loss: 13.0533 | Val Loss: 8.5446 | Dice: 0.4364 | clDice: 0.4778 | IoU: 0.2796 | Tversky: 0.4364 | Hausdorff: 367.3276 | HD95: 110.9476 | LR: 0.001000
2025-07-23 07:41:49 INFO Epoch 023 | Train Loss: 12.9889 | Val Loss: 8.5402 | Dice: 0.4249 | clDice: 0.4586 | IoU: 0.2702 | Tversky: 0.4249 | Hausdorff: 265.0506 | HD95: 92.3568 | LR: 0.001000
2025-07-23 07:44:09 INFO Epoch 024 | Train Loss: 12.7976 | Val Loss: 8.5301 | Dice: 0.4244 | clDice: 0.4614 | IoU: 0.2698 | Tversky: 0.4244 | Hausdorff: 303.7013 | HD95: 98.5740 | LR: 0.001000
2025-07-23 07:46:27 INFO Epoch 025 | Train Loss: 13.1010 | Val Loss: 8.5368 | Dice: 0.4119 | clDice: 0.4432 | IoU: 0.2596 | Tversky: 0.4119 | Hausdorff: 314.6729 | HD95: 104.3938 | LR: 0.001000
2025-07-23 07:48:41 INFO Epoch 026 | Train Loss: 12.9151 | Val Loss: 8.5390 | Dice: 0.4216 | clDice: 0.4567 | IoU: 0.2677 | Tversky: 0.4216 | Hausdorff: 391.7369 | HD95: 115.9878 | LR: 0.001000
2025-07-23 07:50:53 INFO Epoch 027 | Train Loss: 13.0127 | Val Loss: 8.5351 | Dice: 0.4190 | clDice: 0.4518 | IoU: 0.2653 | Tversky: 0.4190 | Hausdorff: 317.9232 | HD95: 102.5714 | LR: 0.001000
2025-07-23 07:53:07 INFO Epoch 028 | Train Loss: 12.9801 | Val Loss: 8.5358 | Dice: 0.4059 | clDice: 0.4395 | IoU: 0.2557 | Tversky: 0.4059 | Hausdorff: 340.3572 | HD95: 119.3213 | LR: 0.001000
2025-07-23 07:55:27 INFO Epoch 029 | Train Loss: 13.0708 | Val Loss: 8.5401 | Dice: 0.3991 | clDice: 0.4294 | IoU: 0.2502 | Tversky: 0.3991 | Hausdorff: 404.5315 | HD95: 132.1696 | LR: 0.001000
2025-07-23 07:57:44 INFO Epoch 030 | Train Loss: 13.0059 | Val Loss: 8.5344 | Dice: 0.4346 | clDice: 0.4736 | IoU: 0.2779 | Tversky: 0.4346 | Hausdorff: 284.0408 | HD95: 91.8161 | LR: 0.001000
2025-07-23 07:59:59 INFO Epoch 031 | Train Loss: 12.8366 | Val Loss: 8.5242 | Dice: 0.4155 | clDice: 0.4488 | IoU: 0.2625 | Tversky: 0.4155 | Hausdorff: 391.9955 | HD95: 116.7250 | LR: 0.001000
2025-07-23 08:02:12 INFO Epoch 032 | Train Loss: 12.9145 | Val Loss: 8.5307 | Dice: 0.4489 | clDice: 0.4901 | IoU: 0.2897 | Tversky: 0.4489 | Hausdorff: 295.9381 | HD95: 79.8483 | LR: 0.001000
2025-07-23 08:04:29 INFO Epoch 033 | Train Loss: 13.0057 | Val Loss: 8.5245 | Dice: 0.4216 | clDice: 0.4561 | IoU: 0.2676 | Tversky: 0.4216 | Hausdorff: 348.8750 | HD95: 110.1106 | LR: 0.001000
2025-07-23 08:06:50 INFO Epoch 034 | Train Loss: 12.9212 | Val Loss: 8.5623 | Dice: 0.3571 | clDice: 0.3843 | IoU: 0.2177 | Tversky: 0.3571 | Hausdorff: 444.8006 | HD95: 165.8470 | LR: 0.001000
2025-07-23 08:09:07 INFO Epoch 035 | Train Loss: 13.1315 | Val Loss: 8.5328 | Dice: 0.3937 | clDice: 0.4231 | IoU: 0.2454 | Tversky: 0.3937 | Hausdorff: 484.7521 | HD95: 149.7746 | LR: 0.001000
2025-07-23 08:11:24 INFO Epoch 036 | Train Loss: 12.2647 | Val Loss: 7.9413 | Dice: 0.4157 | clDice: 0.4526 | IoU: 0.2624 | Tversky: 0.4157 | Hausdorff: 309.4338 | HD95: 97.6461 | LR: 0.001000
2025-07-23 08:13:40 INFO Epoch 037 | Train Loss: 13.0087 | Val Loss: 8.5412 | Dice: 0.4271 | clDice: 0.4646 | IoU: 0.2718 | Tversky: 0.4271 | Hausdorff: 290.2715 | HD95: 89.7950 | LR: 0.001000
2025-07-23 08:16:02 INFO Epoch 038 | Train Loss: 13.0141 | Val Loss: 8.5293 | Dice: 0.4174 | clDice: 0.4495 | IoU: 0.2642 | Tversky: 0.4174 | Hausdorff: 344.9749 | HD95: 104.3649 | LR: 0.001000
2025-07-23 08:18:17 INFO Epoch 039 | Train Loss: 12.9645 | Val Loss: 8.5283 | Dice: 0.4391 | clDice: 0.4762 | IoU: 0.2815 | Tversky: 0.4391 | Hausdorff: 334.9600 | HD95: 105.3303 | LR: 0.001000
2025-07-23 08:20:33 INFO Epoch 040 | Train Loss: 12.7806 | Val Loss: 8.5367 | Dice: 0.4088 | clDice: 0.4388 | IoU: 0.2577 | Tversky: 0.4088 | Hausdorff: 437.7825 | HD95: 119.6283 | LR: 0.001000
2025-07-23 08:22:48 INFO Epoch 041 | Train Loss: 12.8902 | Val Loss: 8.5139 | Dice: 0.4314 | clDice: 0.4649 | IoU: 0.2752 | Tversky: 0.4314 | Hausdorff: 338.6788 | HD95: 103.8092 | LR: 0.001000
2025-07-23 08:25:11 INFO Epoch 042 | Train Loss: 13.0256 | Val Loss: 8.5177 | Dice: 0.4321 | clDice: 0.4657 | IoU: 0.2759 | Tversky: 0.4321 | Hausdorff: 327.6970 | HD95: 89.7887 | LR: 0.001000
2025-07-23 08:27:33 INFO Epoch 043 | Train Loss: 13.1739 | Val Loss: 8.6063 | Dice: 0.4258 | clDice: 0.4590 | IoU: 0.2706 | Tversky: 0.4258 | Hausdorff: 404.5567 | HD95: 95.2850 | LR: 0.001000
2025-07-23 08:29:49 INFO Epoch 044 | Train Loss: 12.9029 | Val Loss: 8.5377 | Dice: 0.4053 | clDice: 0.4382 | IoU: 0.2550 | Tversky: 0.4053 | Hausdorff: 469.9423 | HD95: 137.7355 | LR: 0.001000
2025-07-23 08:32:04 INFO Epoch 045 | Train Loss: 13.0793 | Val Loss: 8.5673 | Dice: 0.4389 | clDice: 0.4801 | IoU: 0.2816 | Tversky: 0.4389 | Hausdorff: 299.5334 | HD95: 88.9057 | LR: 0.001000
2025-07-23 08:34:22 INFO Early stopping at epoch 46 | Best Dice: 0.4489 at epoch 36
2025-07-23 08:35:03 INFO Test Loss: 7.9413 | Dice: 0.4157 | clDice: 0.4526 | IoU: 0.2624 | Tversky: 0.4157 | Hausdorff: 309.4338 | HD95: 97.6461
