2025-08-21 01:05:45 INFO Starting training with configuration: {'model': {'name': 'unet', 'encoder_name': 'se_resnext50_32x4d', 'encoder_weights': 'imagenet', 'classes': 1, 'activation': None, 'dropout': 0.2}, 'dataset': {'root': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers', 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 50, 'num_workers': 4, 'feature_dirs': {'image': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/enhanced_images', 'mask': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/masks', 'distance': '/data/smadper@alumno.upv.es/TFM/datasets/laticifers/distance_maps_pt'}}, 'train': {'batch_size': 32, 'num_epochs': 70, 'learning_rate': 0.001, 'accumulation_steps': 1, 'save_dir': '/data/smadper@alumno.upv.es/TFM/checkpoints_cv2/unet/20250821_010545_unet_se_resnext50_32x4d_cldice', 'log_interval': 1, 'patience': 20, 'mixed_precision': True, 'experiment_name': 'unet_se_resnext50_32x4d_cldice', 'timestamp': '20250821_010545'}, 'test': {'batch_size': 1}, 'loss': {'name': 'cldice', 'cldice_alpha': 0.2, 'tversky_alpha': 0.3, 'tversky_beta': 0.7, 'focal_tversky_gamma': 0.75, 'use_topographic': False, 'combine_with': None, 'weights': {'main': 1.0, 'combined': 0.0}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-08-21 01:05:45 INFO Experiment name: unet_se_resnext50_32x4d_cldice
2025-08-21 01:05:45 INFO ===== Fold 1 / 5 =====
2025-08-21 01:05:45 INFO Loading model unet with settings {'name': 'unet', 'encoder_name': 'se_resnext50_32x4d', 'encoder_weights': 'imagenet', 'classes': 1, 'activation': None, 'dropout': 0.2}
2025-08-21 01:31:52 INFO Epoch 001 | Train Loss: 0.6023 | Val Loss: 0.5414 | Dice: 0.0790 | softDice: 0.0778 | clDice: 0.1491 | softclDice: 0.5263 | IoU: 0.0412 | Tversky: 0.0790 | Hausdorff: 869.1942 | HD95: 390.7792 | val_loss: 0.5414 | LR: 0.001000
2025-08-21 07:24:17 INFO Epoch 002 | Train Loss: 0.4542 | Val Loss: 0.4729 | Dice: 0.0799 | softDice: 0.0784 | clDice: 0.1218 | softclDice: 0.4815 | IoU: 0.0417 | Tversky: 0.0799 | Hausdorff: 869.1942 | HD95: 502.4744 | val_loss: 0.4729 | LR: 0.001000
2025-08-21 12:07:25 INFO Epoch 003 | Train Loss: 0.4454 | Val Loss: 0.4547 | Dice: 0.0796 | softDice: 0.0795 | clDice: 0.1160 | softclDice: 0.4496 | IoU: 0.0415 | Tversky: 0.0796 | Hausdorff: 869.1942 | HD95: 388.5723 | val_loss: 0.4547 | LR: 0.001000
2025-08-21 17:49:37 INFO Epoch 004 | Train Loss: 0.4010 | Val Loss: 0.4246 | Dice: 0.0796 | softDice: 0.0795 | clDice: 0.1299 | softclDice: 0.4204 | IoU: 0.0415 | Tversky: 0.0796 | Hausdorff: 869.1942 | HD95: 285.0863 | val_loss: 0.4246 | LR: 0.001000
2025-08-21 23:31:45 INFO Epoch 005 | Train Loss: 0.3795 | Val Loss: 0.4008 | Dice: 0.0800 | softDice: 0.0800 | clDice: 0.1169 | softclDice: 0.4023 | IoU: 0.0418 | Tversky: 0.0800 | Hausdorff: 869.1942 | HD95: 549.6256 | val_loss: 0.4008 | LR: 0.001000
2025-08-22 05:14:25 INFO Epoch 006 | Train Loss: 0.3805 | Val Loss: 0.4490 | Dice: 0.0803 | softDice: 0.0802 | clDice: 0.1062 | softclDice: 0.4627 | IoU: 0.0419 | Tversky: 0.0803 | Hausdorff: 869.1942 | HD95: 932.8503 | val_loss: 0.4490 | LR: 0.001000
2025-08-22 06:41:31 WARNING /data/smadper@alumno.upv.es/TFM/src/metrics.py:82: RuntimeWarning: Mean of empty slice
  return np.nanmean(distances)

slurmstepd: error: *** JOB 39761 ON vrhpc3.dsic.upv.es CANCELLED AT 2025-08-22T13:08:04 ***
