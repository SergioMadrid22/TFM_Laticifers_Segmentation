2025-06-29 22:39:16 INFO Starting training with configuration: {'model': {'name': 'unet++', 'alias': 'unet_resnet34', 'encoder_name': 'resnet34', 'encoder_weights': 'None', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}, 'dataset': {'root': '/home/smadper/TFM/datasets/laticifers', 'image_size': [512, 512], 'patch_size': [512, 512], 'stride': [256, 256], 'num_patches': 20, 'dataset_csv': 'laticifer_dataset_index.csv', 'num_workers': 8, 'dist_transform': True}, 'train': {'batch_size': 8, 'num_epochs': 50, 'learning_rate': 0.0001, 'accumulation_steps': 1, 'save_dir': '/home/smadper/TFM/checkpoints', 'log_interval': 1, 'patience': 10, 'experiment_name': 'unet++_patched_timm-resnet50d', 'timestamp': '20250629_223916'}, 'test': {'batch_size': 1, 'save_dir': '/home/smadper/TFM/results'}, 'loss': {'name': 'focal_tversky', 'use_topographic': True, 'combine_with': 'dice', 'weights': {'main': 1.0, 'combined': 0.5}, 'topo': {'alpha': 2.0, 'beta': 1.0}}}
2025-06-29 22:39:16 INFO Loading model unet++ with settings {'name': 'unet++', 'alias': 'unet_resnet34', 'encoder_name': 'resnet34', 'encoder_weights': 'None', 'in_channels': 1, 'classes': 1, 'activation': 'sigmoid', 'dropout': 0.0}
2025-06-29 22:40:14 INFO Epoch 001 | Train Loss: 1.5297 | Val Loss: 1.6798 | Dice: 0.1884 | IoU: 0.1043 | LR: 0.000100
2025-06-29 22:41:12 INFO Epoch 002 | Train Loss: 1.4547 | Val Loss: 1.6034 | Dice: 0.2441 | IoU: 0.1393 | LR: 0.000100
2025-06-29 22:42:09 INFO Epoch 003 | Train Loss: 1.3688 | Val Loss: 1.5343 | Dice: 0.2983 | IoU: 0.1759 | LR: 0.000100
2025-06-29 22:43:07 INFO Epoch 004 | Train Loss: 1.3041 | Val Loss: 1.4535 | Dice: 0.3911 | IoU: 0.2432 | LR: 0.000100
2025-06-29 22:44:05 INFO Epoch 005 | Train Loss: 1.2580 | Val Loss: 1.3731 | Dice: 0.4212 | IoU: 0.2669 | LR: 0.000100
2025-06-29 22:45:03 INFO Epoch 006 | Train Loss: 1.2039 | Val Loss: 1.3624 | Dice: 0.3931 | IoU: 0.2448 | LR: 0.000100
2025-06-29 22:46:01 INFO Epoch 007 | Train Loss: 1.1731 | Val Loss: 1.3069 | Dice: 0.4393 | IoU: 0.2815 | LR: 0.000100
2025-06-29 22:46:59 INFO Epoch 008 | Train Loss: 1.1571 | Val Loss: 1.2965 | Dice: 0.4338 | IoU: 0.2770 | LR: 0.000100
2025-06-29 22:47:57 INFO Epoch 009 | Train Loss: 1.1295 | Val Loss: 1.2988 | Dice: 0.4350 | IoU: 0.2780 | LR: 0.000100
2025-06-29 22:48:55 INFO Epoch 010 | Train Loss: 1.1129 | Val Loss: 1.2214 | Dice: 0.4538 | IoU: 0.2937 | LR: 0.000100
2025-06-29 22:49:53 INFO Epoch 011 | Train Loss: 1.1134 | Val Loss: 1.2381 | Dice: 0.4361 | IoU: 0.2790 | LR: 0.000100
2025-06-29 22:50:51 INFO Epoch 012 | Train Loss: 1.1068 | Val Loss: 1.2290 | Dice: 0.4446 | IoU: 0.2861 | LR: 0.000100
2025-06-29 22:51:49 INFO Epoch 013 | Train Loss: 1.1033 | Val Loss: 1.2448 | Dice: 0.4387 | IoU: 0.2810 | LR: 0.000100
2025-06-29 22:52:47 INFO Epoch 014 | Train Loss: 1.0802 | Val Loss: 1.2029 | Dice: 0.4406 | IoU: 0.2828 | LR: 0.000100
2025-06-29 22:53:45 INFO Epoch 015 | Train Loss: 1.0687 | Val Loss: 1.2363 | Dice: 0.4395 | IoU: 0.2817 | LR: 0.000100
2025-06-29 22:54:44 INFO Epoch 016 | Train Loss: 1.0592 | Val Loss: 1.2082 | Dice: 0.4365 | IoU: 0.2793 | LR: 0.000100
2025-06-29 22:55:42 INFO Epoch 017 | Train Loss: 1.0640 | Val Loss: 1.2321 | Dice: 0.4297 | IoU: 0.2738 | LR: 0.000100
2025-06-29 22:56:41 INFO Epoch 018 | Train Loss: 1.0737 | Val Loss: 1.1948 | Dice: 0.4546 | IoU: 0.2942 | LR: 0.000100
2025-06-29 22:57:39 INFO Epoch 019 | Train Loss: 1.0441 | Val Loss: 1.2169 | Dice: 0.4516 | IoU: 0.2918 | LR: 0.000100
2025-06-29 22:58:36 INFO Epoch 020 | Train Loss: 1.0391 | Val Loss: 1.2077 | Dice: 0.4385 | IoU: 0.2810 | LR: 0.000100
2025-06-29 22:59:34 INFO Epoch 021 | Train Loss: 1.0322 | Val Loss: 1.1811 | Dice: 0.4553 | IoU: 0.2948 | LR: 0.000100
2025-06-29 23:00:32 INFO Epoch 022 | Train Loss: 1.0357 | Val Loss: 1.2018 | Dice: 0.4472 | IoU: 0.2881 | LR: 0.000100
2025-06-29 23:01:30 INFO Epoch 023 | Train Loss: 1.0279 | Val Loss: 1.1933 | Dice: 0.4384 | IoU: 0.2808 | LR: 0.000100
2025-06-29 23:02:29 INFO Epoch 024 | Train Loss: 1.0248 | Val Loss: 1.2152 | Dice: 0.4204 | IoU: 0.2662 | LR: 0.000100
2025-06-29 23:03:26 INFO Epoch 025 | Train Loss: 1.0037 | Val Loss: 1.2017 | Dice: 0.4418 | IoU: 0.2836 | LR: 0.000100
2025-06-29 23:04:24 INFO Epoch 026 | Train Loss: 1.0024 | Val Loss: 1.2063 | Dice: 0.4289 | IoU: 0.2732 | LR: 0.000100
2025-06-29 23:05:23 INFO Epoch 027 | Train Loss: 0.9881 | Val Loss: 1.2134 | Dice: 0.4196 | IoU: 0.2656 | LR: 0.000100
2025-06-29 23:06:22 INFO Epoch 028 | Train Loss: 0.9813 | Val Loss: 1.2247 | Dice: 0.4057 | IoU: 0.2545 | LR: 0.000100
2025-06-29 23:07:20 INFO Epoch 029 | Train Loss: 0.9668 | Val Loss: 1.2124 | Dice: 0.4287 | IoU: 0.2730 | LR: 0.000100
2025-06-29 23:08:18 INFO Epoch 030 | Train Loss: 0.9616 | Val Loss: 1.2035 | Dice: 0.4313 | IoU: 0.2751 | LR: 0.000100
2025-06-29 23:09:16 INFO Early stopping at epoch 31 | Best Dice: 0.4553 at epoch 21
2025-06-29 23:09:54 INFO Test Loss: 1.1811 | Dice: 0.4553 | IoU: 0.2948
